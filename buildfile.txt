BUILD SUCCESSFUL

Total time: 11 mins 21.62 secs
Task timings:  â€‹94205ms  :classpathCheck
  â€‹7126ms  :validateListhubReferences
   â€‹623ms  :clea
 â€‹203218ms  :compileJava
  â€‹1784ms  :processResources  â€‹20511ms  :compileTestJava
  â€‹3183ms  :processTestResource
 â€‹341995ms  :test
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // retry
[Pipeline] ansiCode)
[Pipelinede)
[Pipeline] ed)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // stage
[Pipeline] ansiCode)
[Pipelinede)
[Pipeline] ed)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryResoude)
[Pipeline]de)
[Pipeline]de)
[Pipeline]de)
[Pipeline]de)
[Pipeline] archiveArtifad)
ï¿¼Archiving artifacts
[Pipeline]d)
ï¿¼+ rm /tmp/tmp.ks7MAQ3OkC
[Pipeline] stde)
[Pipeline] { (Docker Pude)
[Pipeline]d)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipeline]d)
ï¿¼+ git rev-parse HEAD
[Pipeline] httpRequde)
[Pipeline] ansiCode)
[Pipelinede)
[Pipeline] ed)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.artifactoryDockerTagAndPush; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeline] newArtifactorySerde)
[Pipeline] rede)
[Pipelinede)
[Pipeline] newBuildIde)
[Pipeline] dockerPushSde)
expected to call org.jfrog.hudson.pipeline.common.types.Docker.push but wound up catching dockerPushStep; see: https://jenkins.io/redirect/pipeline-cps-method-mismatche/
ï¿¼Pushing image: docker.artifactory.moveaws.com/listhub/listhub:5ecee24
Could not find corresponding manifest.json file in Artifactory.
Could not find docker image: docker.artifactory.moveaws.com/listhub/listhub:5ecee24 in Artifactory.
Successfully pushed docker image: docker.artifactory.moveaws.com/listhub/listhub:5ecee24
[Pipeline] }
[Pipeline] // retry
[Pipeline] rede)
[Pipelinede)
[Pipeline]d)
ï¿¼+ docker tag docker.artifactory.moveaws.com/listhub/listhub:5ecee24 docker.artifactory.moveaws.com/listhub/listhub:latest
[Pipeline] }
[Pipeline] // retry
[Pipeline] rede)
[Pipelinede)
[Pipeline] newBuildIde)
[Pipeline] dockerPushSde)
expected to call org.jfrog.hudson.pipeline.common.types.Docker.push but wound up catching dockerPushStep; see: https://jenkins.io/redirect/pipeline-cps-method-mismatche/
ï¿¼Pushing image: docker.artifactory.moveaws.com/listhub/listhub:latest
Could not find corresponding manifest.json file in Artifactory.
Could not find docker image: docker.artifactory.moveaws.com/listhub/listhub:latest in Artifactory.
Successfully pushed docker image: docker.artifactory.moveaws.com/listhub/listhub:latest
[Pipeline] }
[Pipeline] // retry
[Pipeline] ansiCode)
[Pipelinede)
[Pipeline] ed)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline]d)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipeline]d)
ï¿¼+ git rev-parse HEAD
[Pipeline] httpRequde)
[Pipeline] }
[Pipeline] // stage
[Pipeline] ansiCode)
[Pipelinede)
[Pipeline] ed)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryResoude)
[Pipeline]de)
[Pipeline]de)
[Pipeline]de)
[Pipeline]de)
[Pipeline] archiveArtifad)
ï¿¼Archiving artifacts
[Pipeline]d)
ï¿¼+ rm /tmp/tmp.SaiPBrDHXW
[Pipeline] stde)
[Pipeline] { (Docker Scde)
[Pipeline]d)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipeline]d)
ï¿¼+ git rev-parse HEAD
[Pipeline] httpRequde)
[Pipeline] ansiCode)
[Pipelinede)
[Pipeline] ed)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] ed)
ï¿¼ â€‹Skipping vulnerability scan. Not supported for JFrog Artifactory registry
[Pipeline] ansiCide)
[Pipelinide)
[Pipeline] ie)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipelineie)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipelineie)
ï¿¼+ git rev-parse HEAD
[Pipeline] httpReqide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] ansiCide)
[Pipelinide)
[Pipeline] ie)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryResoide)
[Pipelineide)
[Pipelineide)
[Pipelineide)
[Pipelineide)
[Pipeline] archiveArtifie)
ï¿¼Archiving artifacts
[Pipelineie)
ï¿¼+ rm /tmp/tmp.zYA6kL2Opi
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // node
[Pipeline] paraide)
[Pipeline] { (Branch: blackdide)
[Pipeline] { (Branch: mide)
[Pipeline] ide)
[Pipeline] paraide)
[Pipeline] { (Branch: ide)
[Pipeline] { (Branch:ide)
[Pipeline] ie)
ï¿¼Skipping dev build since devAccount is not set.
[Pipeline }
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[Pipeline] ie)
ï¿¼Skipping qa build since qaAccount is not set.
[Pipeline] }
[Pipelinide)
[Pipeline] // parallel
[Pipeline] ie)
ï¿¼Skipping int build since intEnvFileName is not set.
[Pipeline] checide)
[Pipeline] ie)
ï¿¼Deploying environment: envVarPrefix=prod, args=[account:[accountId:104222541211, region:us-east-1, shortEnv:prod, yamlVariableFilename:aws-listhub-prod-us-east-1.yml, elbVariableFilename:elb-internet-facing.yml], accountShortEnv:prod, environmentType:trunk, ecsDeployType:blueGreen, ecsCanaryLifetimeTimeoutMins:5, ecsWeightedBlueGreenLifetimeTimeoutMins:5, ecsCleanupTimeoutMins:120, slackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@55b59ad4, githubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@6b7af71c, sendNotifications:[], envVarPrefix:prod, envNameSuffix:prod, envName:listhub-prod, envFileName:listhub-prod, devAccount:null, devCfInfrastructureProfile:dev, devCfForceApproveAfterXHours:null, devCfManuallyApproveChangeSetTimeoutHours:null, devCfSendNotificationOnManualApproval:false, devManuallyApproveDeployTimeoutHours:null, devEnvNameSuffix:dev, devEnvType:trunk, devStackMaxLifetimeHours:null, devSkipIfEnvFileNameNotSet:false, devEcsDeployType:blueGreen, devEcsCanaryLifetimeTimeoutMins:1, devEcsWeightedBlueGreenLifetimeTimeoutMins:1, devEcsCleanupTimeoutMins:1, devSlackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@17e8c59f, devGithubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@2a1e456e, devSendNotifications:[], qaAccount:null, qaCfInfrastructureProfile:qa, qaCfForceApproveAfterXHours:null, qaCfManuallyApproveChangeSetTimeoutHours:null, qaCfSendNotificationOnManualApproval:false, qaManuallyApproveDeployTimeoutHours:null, qaEnvNameSuffix:qa, qaEnvType:trunk, qaStackMaxLifetimeHours:null, qaSkipIfEnvFileNameNotSet:false, qaEcsDeployType:blueGreen, qaEcsCanaryLifetimeTimeoutMins:1, qaEcsWeightedBlueGreenLifetimeTimeoutMins:1, qaEcsCleanupTimeoutMins:1, qaSlackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@600709f6, qaGithubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@76ac87c8, qaSendNotifications:[], prodAccount:[accountId:104222541211, region:us-east-1, shortEnv:prod, yamlVariableFilename:aws-listhub-prod-us-east-1.yml, elbVariableFilename:elb-internet-facing.yml], prodCfInfrastructureProfile:prod, prodCfForceApproveAfterXHours:null, prodCfManuallyApproveChangeSetTimeoutHours:8, prodCfSendNotificationOnManualApproval:false, prodManuallyApproveDeployTimeoutHours:null, prodEnvNameSuffix:prod, prodEnvType:trunk, prodStackMaxLifetimeHours:null, prodSkipIfEnvFileNameNotSet:false, prodEcsDeployType:blueGreen, prodEcsCanaryLifetimeTimeoutMins:5, prodEcsWeightedBlueGreenLifetimeTimeoutMins:5, prodEcsCleanupTimeoutMins:120, prodSlackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@55b59ad4, prodGithubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@6b7af71c, prodSendNotifications:[], intAccount:null, intCfInfrastructureProfile:null, intCfForceApproveAfterXHours:null, intCfManuallyApproveChangeSetTimeoutHours:null, intCfSendNotificationOnManualApproval:false, intManuallyApproveDeployTimeoutHours:2, intEnvNameSuffix:qa-int, intEnvType:int, intStackMaxLifetimeHours:null, intSkipIfEnvFileNameNotSet:true, intEcsDeployType:blueGreen, intEcsCanaryLifetimeTimeoutMins:1, intEcsWeightedBlueGreenLifetimeTimeoutMins:1, intEcsCleanupTimeoutMins:1, intSlackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@f23ac0, intGithubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@7dd1ce39, intSendNotifications:[], prAccount:null, prCfInfrastructureProfile:null, prCfForceApproveAfterXHours:null, prCfManuallyApproveChangeSetTimeoutHours:null, prCfSendNotificationOnManualApproval:false, prManuallyApproveDeployTimeoutHours:null, prEnvNameSuffix:qa-pr, prEnvType:pr, prStackMaxLifetimeHours:8, prSkipIfEnvFileNameNotSet:false, prEcsDeployType:blueGreen, prEcsCanaryLifetimeTimeoutMins:1, prEcsWeightedBlueGreenLifetimeTimeoutMins:1, prEcsCleanupTimeoutMins:1, prSlackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@5dc97028, prGithubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@4dff3b5f, prSendNotifications:[deletePipelineInput, deployFinish, deleteFinish], stagingAccount:null, stagingCfInfrastructureProfile:null, stagingCfForceApproveAfterXHours:null, stagingCfManuallyApproveChangeSetTimeoutHours:8, stagingCfSendNotificationOnManualApproval:false, stagingManuallyApproveDeployTimeoutHours:null, stagingEnvNameSuffix:qa-staging, stagingEnvType:staging, stagingStackMaxLifetimeHours:null, stagingSkipIfEnvFileNameNotSet:false, stagingEcsDeployType:blueGreenWithCanary, stagingEcsCanaryLifetimeTimeoutMins:5, stagingEcsWeightedBlueGreenLifetimeTimeoutMins:5, stagingEcsCleanupTimeoutMins:10, stagingSlackGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@58e2a24c, stagingGithubGenerateMessage:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@29df000a, stagingSendNotifications:[], additionalInfrastructureTags:[], additionalVarsFiles:[deployment/vars.listhub-common.yml], allowConcurrentBuildsDuringInputForNewDeployment:true, appName:listhub, approvers:null, awsDeployToolsTag:latest, baseBranch:master, blackduckCopyPathsFromContainerToHostForScan:[[/app/listhub/build/, build/], [/usr/share/listhub/java/war, build/extracted-war]], blackduckEnabled:true, blackduckNoticesReport:true, blackduckPolicyCheck:false, blackduckPolicyCheckFailOnSeverities:Trivial,Minor,Major,Critical,Blocker, blackduckProjectDistribution:Internal, blackduckRiskReport:true, blackduckScanDockerImage:true, blueGreenTest:org.jenkinsci.plugins.workflow.cps.CpsClosure2@4dd4d003, branchingStrategy:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@1d5a4bc4, buildCommand:null, buildDockerContext:., buildDockerArgs:[GIT_SHA=$(git rev-parse --short HEAD), GIT_BRANCH=$BRANCH_NAME], buildDockerSkipImageExistCheck:false, buildDockerImage:listhub/listhub, bumpNpmPackageVersionOnConflict:true, cfInfrastructureTemplatePath:org.jenkinsci.plugins.workflow.cps.CpsClosure2@56361a54, cfnNagFailBuildOnViolation:false, cfnNagCustomRuleOrg:InnerOpenSource, cfnNagCustomRuleRepo:move-cfnnag-rules, cfnNagCustomRuleDir:custom-rules, cfnLintFailBuildOnViolation:true, checkmarxEnabled:false, checkmarxFailBuildOnNewResults:false, checkmarxIncrementalScan:true, checkmarxPreset:3, checkmarxProject:null, checkmarxWaitForScan:false, securityEnabled:true, securityWaitForResults:false, cloudformationDir:null, cloudformationEnvName:org.jenkinsci.plugins.workflow.cps.CpsClosure2@7a0e6d78, cloudformationExtraYamlVars:[], containerAppPath:/app, containerRegistry:[getBuildinfo:org.jenkinsci.plugins.workflow.cps.CpsClosure2@6f9bfdcc, login:org.jenkinsci.plugins.workflow.cps.CpsClosure2@2627f98f, getDigest:org.jenkinsci.plugins.workflow.cps.CpsClosure2@35420d24, imageExists:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@26936cc8, build:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@64f1d7a2, vulnScan:org.jenkinsci.plugins.workflow.cps.CpsClosure2@13ba71ba, tagAndPush:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@6bf4a26c, run:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@53ee7bdb, runWithSts:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@3612ab5a, runAsCurrentUser:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@6a0abdff, runAndCopyFiles:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@6df1b726, pull:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@4914a7b8, getImageSize:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@3352223d, getBuildExistingTags:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@59113d38], deleteWorkspaceBeforeBuild:false, deleteWorkspaceAfterBuild:false, deployConfigDir:deployment, devBranch:master, directSlackNotification:null, ecsCluster:listhub-web-ecs-cluster, ecsClusterType:web, ecsServiceAlbOptions:[ecsBGCommonCFTemplate:ecs-service-bg-common.template, ecsServiceCFTemplate:ecs-service-alb-cloudformation.template, ecsServiceCanaryCfTemplate:ecs-service-canary.template, httpListenerExport:{{ ecsCluster }}-{{ accountAlbScheme }}-http-listener, httpsListenerExport:{{ ecsCluster }}-{{ accountAlbScheme }}-https-listener], featureBranchPrefix:feature/, gitUpdateStatus:true, jenkinsSlaveName:LINUXCO7, mainContainerName:listhub, mainContainerPort:8080, pipelineEventNotificationsEnabled:true, pipelineEventNotificationsEventsTopicArn:arn:aws:sns:us-west-2:860429940966:PipelineEvents, pipelineEventNotificationsAccountRegion:us-west-2, pipelineEventNotificationsAccountId:833973702035, pipelineProperties:[@disableConcurrentBuilds()], prPromptToDeleteStack:true, preBuildCallback:null, postBuildCallback:null, preDeleteCallback:null, postDeleteCallback:null, preDeployCallback:null, postCloudFormationCallback:null, postDeployCallback:null, postDeployCleanupCallback:null, prodBranch:master, prodBranchPrefix:null, qaBranch:master, s3MaxAge:60, shortShaLen:7, sproxyBucket:, slackChannel:listhub-status, stagingBranchPrefix:staging/, testDockerImage:org.jenkinsci.plugins.workflow.cps.CpsClosure2@2a9487b0, version:null, prDeployStack:true, disableScaledownAlarm:false, nrMonitorConfig:deployment/newrelic/monitors.yml, smokeTest:org.jenkinsci.plugins.workflow.cps.CpsClosure2@5471f41a, branchDeployOverrides:[^feature/web-:[prEnvFileName:deployment/vars.listhub-pr.yml, prAccount:[accountId:104222541211, region:us-east-1, shortEnv:prod, yamlVariableFilename:aws-listhub-prod-us-east-1.yml, elbVariableFilename:elb-internal.yml]]], deployEnvironment:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@2050975e, deleteEnvironment:org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure@55076c69, pipelineInstanceId:listhub-371-5ecee24, pipelineTimeStart:2020/12/01-20:40:32, buildStatus:started, envStateChangeLogger:org.jenkinsci.plugins.workflow.cps.CpsClosure2@40996867, buildinfo:[dockerBaseUrl:docker.artifactory.moveaws.com/listhub/listhub, dockerUrl:docker.artifactory.moveaws.com/listhub/listhub:5ecee24, dockerRepo:listhub/listhub, registryUrl:docker.artifactory.moveaws.com, version:5ecee24, context:., buildArgs:[GIT_SHA=$(git rev-parse --short HEAD), GIT_BRANCH=$BRANCH_NAME]], qaIntAccount:null, testEnvName:null]
[Pipeline] ie)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168acf5
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master@2
[Pipelinide)
[Pipeline] checie)
ï¿¼Fetching changes from the remote Git repository
Fetching without tgs
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tgs
ï¿¼Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-178'"
ï¿¼Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-1784'"
[Pipeline] side)
[Pipeline] { (Blackduck Side)
[Pipeline] ansiCide)
[Pipelinide)
[Pipeline] ie)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipelineie)
ï¿¼ â€‹> git rev-parse --is-inside-work-tree # timeout10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/listhub.it
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key from maser
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origin/maser
 â€‹> git config core.sparsecheckout # timeout10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc4670557b7
ï¿¼ â€‹> git rev-parse --is-inside-work-tree # timeou=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/listhubgit
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key from mater
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origin/mater
 â€‹> git config core.sparsecheckout # timeou=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
[Pipeline] ans(hide)
[Pipel(hide)
[Pipeline(ide)
ï¿¼Executing move_new_relic_notify.template
[Pipeline] file(hide)
[Pipeli(ide)
ï¿¼Unable to find image 'docker.artifactory.moveaws.com/listhub/listhub:5ecee24' locally
5ecee24: Pulling from listhub/listhub
f22ccc0b8772: Pulling fs layer
3cf8fb62ba5f: Pulling fs layer
e80c964ece6a: Pulling fs layer
a375b6afd0bb: Pulling fs layer
cbba3d811d43: Pulling fs layer
fd434ba3e0c7: Pulling fs layer
c3d8ed5c9573: Pulling fs layer
71f4b4593d71: Pulling fs layer
6290f02b762f: Pulling fs layer
c3d8ed5c9573: Waiting
cbba3d811d43: Waiting
fd434ba3e0c7: Waiting
6290f02b762f: Waiting
3cf8fb62ba5f: Verifying Checksum
3cf8fb62ba5f: Download complete
e80c964ece6a: Download complete
cbba3d811d43: Verifying Checksum
cbba3d811d43: Download complete
f22ccc0b8772: Download complete
[Pipeline] wri(hide)
[Pipeline] wri(hide)
[Pipeli(hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeli(ide)
ï¿¼f22ccc0b8772: Pull complete
3cf8fb62ba5f: Pull complete
a375b6afd0bb: Verifying Checksum
a375b6afd0bb: Download complete
e80c964ece6a: Pull comlete
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeli(ide)
ï¿¼71f4b4593d71: Verifying Checksum
71f4b4593d71: Download complete
a375b6afd0bb: Pull complete
[Pipeli(ide)
ï¿¼cbba3d811d43: Pull complete
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeli(ide)
ï¿¼c3d8ed5c9573: Verifying Checksum
c3d8ed5c9573: Download comlete
ï¿¼Skipping New Relic deployment notification since the newRelicAppId variable is notset.
ï¿¼fd434ba3e0c7: Verifying Checksum
fd434ba3e0c7: Download complete
6290f02b762f: Download complete
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] ans(hide)
[Pipel(hide)
[Pipeline(ide)
ï¿¼Executing move_sns_send.sh.template
[Pipeline] file(hide)
[Pipeli(hide)
[Pipeline] wri(hide)
[Pipeline] wri(hide)
[Pipeli(hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeli(ide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeli(hide)
[Pipeli(hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeli(ide)
ï¿¼Skipping SNS notification since a topic ARN is not configured.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // node
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching movePipelineECS.deployEnvironment; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipeline(ide)
ï¿¼Performing ECS deployment type blueGreen.
[Pipeline(ide)
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master@2
[Pipel(hide)
[Pipeline] ch(ide)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tags
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-1784'"
[Pipeline] ans(hide)
[Pipel(hide)
[Pipeline(ide)
ï¿¼Executing move_ecs_blue_green_deploy_meta.sh.template
[Pipeline] file(hide)
[Pipeli(ide)
ï¿¼ â€‹> git rev-parse --is-inside-work-tree # timeot=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/listhu.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key from mster
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origin/mster
 â€‹> git config core.sparsecheckout # timeot=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ et +x
ï¿¼fd434ba3e0c7: Pull coplete
ï¿¼+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ META=jenkins-deploy/.__ECS_BG_META_listhub-prod.yml
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/ecs_blue_green_meta.py --ecs_cluster listhub-web-ecs-cluster --stack_name_prefix listhub-prod --active_alb_hostname1 app.listhub.moveaws.com --active_alb_hostname2 app.listhub.com --active_alb_hostname3 app.listhub.net --active_alb_hostname4 reports.listhub.com --active_alb_hostname5 reports.listhub.net --active_alb_hostname6 listings.listhub.com --active_alb_hostname7 listings.listhub.net --active_alb_hostname8 feeds.listhub.net --active_alb_hostname9 feeds.listhub.com --active_alb_hostname10 '' --inactive_alb_hostname1 i-app.listhub.moveaws.com --alb_priority_range_min 15001 --alb_priority_range_max 49999 --listener_exports listhub-web-ecs-cluster-internet-facing-http-listener listhub-web-ecs-cluster-internet-facing-https-listener --outfile jenkins-deploy/.__ECS_BG_META_listhub-prod.yml --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole --stack_min_containers_count 4 --can_optimize_pre_deploymnt ''
ï¿¼c3d8ed5c9573: Pull complete
71f4b4593d71: Pull coplete
ï¿¼[38;21m2020-12-01 21:10:31,600 Found listener ARNs ['arn:aws:elasticloadbalancing:us-east-1:104222541211:listener/app/listh-Inter-1BUT2AQQQJ7E8/17b5fcd6770616ea/93da94ffc4dc8f68', 'arn:aws:elasticloadbalancing:us-east-1:104222541211:listener/app/listh-Inter-1BUT2AQQQJ7E8/17b5fcd6770616ea/1706bb5780f02e65']
[38;21m2020-12-01 21:10:32,472 Found existing ALB priorities {'35309', '15697', '41420', '18219', '45271', '47378', '27206', '38143', '26286', '29194', '31570', '20008', '31933', '18301', '48060', '20048', '18657'}
[38;21m2020-12-01 21:10:32,472 Allocated random ALB priority 31608 from range 15001-49999
[38;21m2020-12-01 21:10:32,688 Found existing ALB priorities {'35309', '15697', '41420', '18219', '45271', '47378', '27206', '38143', '26286', '29194', '31570', '20008', '31933', '18301', '48060', '31608', '20048', '18657'}
[38;21m2020-12-01 21:10:32,688 Allocated random ALB priority 16224 from range 15001-49999
[38;21m2020-12-01 21:10:32,916 Found existing ALB priorities {'47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '18301', '48060', '20048', '15697', '45271', '27206', '26286', '29194'}
[38;21m2020-12-01 21:10:32,916 Allocated random ALB priority 39772 from range 15001-49999
[38;21m2020-12-01 21:10:33,130 Found existing ALB priorities {'47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '18301', '48060', '20048', '15697', '45271', '27206', '26286', '29194', '39772'}
[38;21m2020-12-01 21:10:33,130 Allocated random ALB priority 43980 from range 15001-49999
[38;21m2020-12-01 21:10:33,349 Found existing ALB priorities {'47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '18301', '48060', '43980', '20048', '15697', '45271', '27206', '26286', '29194', '39772'}
[38;21m2020-12-01 21:10:33,349 Allocated random ALB priority 42554 from range 15001-49999
[38;21m2020-12-01 21:10:33,579 Found existing ALB priorities {'47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '18301', '48060', '43980', '20048', '15697', '45271', '27206', '42554', '26286', '29194', '39772'}
[38;21m2020-12-01 21:10:33,579 Allocated random ALB priority 17378 from range 15001-49999
[38;21m2020-12-01 21:10:33,799 Found existing ALB priorities {'47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '15697', '45271', '27206', '42554', '26286', '29194', '39772'}
[38;21m2020-12-01 21:10:33,799 Allocated random ALB priority 28544 from range 15001-49999
[38;21m2020-12-01 21:10:34,062 Found existing ALB priorities {'28544', '47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '15697', '45271', '27206', '42554', '26286', '29194', '39772'}
[38;21m2020-12-01 21:10:34,062 Allocated random ALB priority 49618 from range 15001-49999
[38;21m2020-12-01 21:10:34,399 Found existing ALB priorities {'28544', '47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772'}
[38;21m2020-12-01 21:10:34,399 Allocated random ALB priority 25800 from range 15001-49999
[38;21m2020-12-01 21:10:34,619 Found existing ALB priorities {'28544', '47378', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', -1}
[38;21m2020-12-01 21:10:34,619 Allocated random ALB priority 20859 from range 15001-49999
[38;21m2020-12-01 21:10:34,845 Found existing ALB priorities {'28544', '47378', '20859', '38143', '31570', '20008', '16224', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', -1}
[38;21m2020-12-01 21:10:34,845 Allocated random ALB priority 20905 from range 15001-49999
[38;21m2020-12-01 21:10:35,073 Found existing ALB priorities {'28544', '47378', '20859', '38143', '31570', '20008', '16224', '20905', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', -1}
[38;21m2020-12-01 21:10:35,073 Allocated random ALB priority 35054 from range 15001-49999
[38;21m2020-12-01 21:10:35,294 Found existing ALB priorities {'28544', '47378', '20859', '38143', '35054', '31570', '20008', '16224', '20905', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', -1}
[38;21m2020-12-01 21:10:35,294 Allocated random ALB priority 30028 from range 15001-49999
[38;21m2020-12-01 21:10:35,513 Found existing ALB priorities {'28544', '47378', '20859', '38143', '35054', '31570', '20008', '16224', '20905', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', '30028', -1}
[38;21m2020-12-01 21:10:35,513 Allocated random ALB priority 16897 from range 15001-49999
[38;21m2020-12-01 21:10:35,740 Found existing ALB priorities {'16897', '28544', '47378', '20859', '38143', '35054', '31570', '20008', '16224', '20905', '35309', '18657', '31608', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', '30028', -1}
[38;21m2020-12-01 21:10:35,741 Allocated random ALB priority 18837 from range 15001-49999
[38;21m2020-12-01 21:10:35,962 Found existing ALB priorities {'16897', '28544', '47378', '20859', '38143', '35054', '31570', '20008', '16224', '20905', '35309', '18837', '31608', '18657', '41420', '18219', '31933', '17378', '18301', '48060', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', '30028', -1}
[38;21m2020-12-01 21:10:35,962 Allocated random ALB priority 18894 from range 15001-49999
[38;21m2020-12-01 21:10:36,188 Found existing ALB priorities {'16897', '28544', '47378', '20859', '38143', '35054', '31570', '20008', '16224', '20905', '35309', '18837', '31608', '18657', '41420', '18219', '31933', '17378', '18301', '48060', '18894', '43980', '20048', '49618', '15697', '45271', '27206', '42554', '26286', '29194', '39772', '25800', '30028', -1}
[38;21m2020-12-01 21:10:36,188 Allocated random ALB priority 15104 from range 15001-49999
2020-12-01 21:10:39,831 Deployment Metrics
{"cluster_name": "listhub-web-ecs-cluster", "service_name": "listhub-prod-blue", "service_min_count": 4, "prev_desired_num": 4, "cluster_info": {"largest_container_cpu": 256, "instance_type": "m5.2xlarge", "largest_container_memory": 7168, "asg_name": "listhub-web-ecs-cluster-ECSAutoScalingGroup-1OT4REVQXS7AP"}, "asg_statistics": {"min_instance_count": 4, "max_instance_count": 12, "desired_instance_count": 4}, "cluster_stats": {"registered_container_instances_count": 4, "pending_tasks_count": 0, "running_tasks_count": 18}, "instance_type_info": {"memory": 32768, "vcpu": 8192}, "schedulable_containers": 10, "additional_containers_count": 0, "containers_per_ec2_instance": 4, "additional_ecs_instances_count": 0, "new_asg_desired_capacity": null}
+ chmod 0666 jenkins-deploy/.__ECS_BG_META_listhub-prod.yml
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] r (hide)
[Pipelin hide)
ï¿¼Reading ECS blue / green metadata
[activeAlbHostname=app.listhub.moveaws.com, activeAlbHostname2=app.listhub.com, activeAlbHostname3=app.listhub.net, activeAlbHostname4=reports.listhub.com, activeAlbHostname5=reports.listhub.net, activeAlbHostname6=listings.listhub.com, activeAlbHostname7=listings.listhub.net, activeAlbHostname8=feeds.listhub.net, activeAlbHostname9=feeds.listhub.com, activeAlbHostname10=, inactiveAlbHostname=i-app.listhub.moveaws.com, newDeployStackName=listhub-prod-green, newDeployPriority=25800, newDeployPriority2=31608, newDeployPriority3=16224, newDeployPriority4=39772, newDeployPriority5=43980, newDeployPriority6=42554, newDeployPriority7=17378, newDeployPriority8=28544, newDeployPriority9=49618, newDeployPriority10=-1, prevDeployStackName=listhub-prod-blue, prevDeployPriority=27206, prevDeployPriority2=35309, prevDeployPriority3=18301, prevDeployPriority4=18219, prevDeployPriority5=29194, prevDeployPriority6=45271, prevDeployPriority7=47378, prevDeployPriority8=31570, prevDeployPriority9=15697, prevDeployPriority10=-1, prevStackExists=1, prevDesiredCount=4]
[Pipeline (hide)
[Pipeline] { (prod Blue / Green  (hide)
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼Executing move_ecs_blue_green_deploy_phase1_common.sh.template
[Pipeline] fil hide)
ï¿¼6290f02b762f: Pull complete
Digest: sha256:a86eaf9f6d53fa4e1f7565594a0cc53bed87e1747bf7d8dccecf3e3991ec55ca
Status: Downloaded newer image for docker.artifactory.moveaws.com/listhub/listhub:5ecee24
[Pipel (hide)
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼a3e1ff46ee9a6a74dc33f3fac076c568ceeebefa1908023bf75447e462bbc830
[Pipel hide)
ï¿¼+ vault kv get --field=username kv/external-tools-secrets/blackduck
[Pipel hide)
ï¿¼+ vault kv get --field=password kv/external-tools-secrets/blackduck
[Pipel hide)
ï¿¼+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_simple_deploy.py --stack_name listhub-prod-bg-common --cf_template_path /usr/local/aws-deploy-tools/templates/ecs-service-bg-common.template --extra_tag Name=listhub-prod owner=sysadmin@listhub.com product=listhub component=app environment=prod --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
[38;21m2020-12-01 21:11:10,216 Rendered CloudFormation template:
Description: app.listhub.moveaws.com DNS entries.

Resoures:
  â€‹dns:
    â€‹Type: AWS::Route53::RecordSetGrop
    â€‹Properties:      â€‹HostedZoneId: "Z1WPQLJ0FIWUYK"      â€‹RecordSets:
       â€‹- Name: "app.listhub.moveaws.com"
         â€‹Type: "A"
         â€‹AliasTarget:
           â€‹HostedZoneId:
             â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-hosted-zone-id"
           â€‹DNSName:
             â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-rl"
  â€‹dns:
    â€‹Type: AWS::Route53::RecordSetGrop
    â€‹Properties:      â€‹HostedZoneId: "Z1WPQLJ0FIWUYK"      â€‹RecordSets:
       â€‹- Name: "i-app.listhub.moveaws.com"
         â€‹Type: "A"
         â€‹AliasTarget:
           â€‹HostedZoneId:
             â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-hosted-zone-id"
           â€‹DNSName:
             â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-url"












[38;21m2020-12-01 21:11:10,216 Deploying stack listhub-prod-bg-common.
[38;21m2020-12-01 21:11:10,216 stack_paras: []
ï¿¼+ git config remote.origin.url
[Pipel (hide)
[Pipeline] wr (hide)
[Pipelin hide)
ï¿¼This function is DEPRECIATED.
[Pipel (hide)
[Pipelin hide)
ï¿¼Finished Blackduck scan.
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // stage
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryR (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipeline] archiveAr hide)
ï¿¼Archiving artifacts
[Pipel hide)
ï¿¼+ rm /tmp/tmp.nNI0f8o5gh
[Pipeline] }
[Pipeline] // node
[Pipelne] }
ï¿¼[38;21m2020-12-01 21:11:23,607 Finished CF deployment in 0:00:16.279454.
INFO: Skipping Terminate Protect as flag is not set
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryR (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipeline] archiveAr hide)
ï¿¼Archiving artifacts
[Pipel hide)
ï¿¼+ rm /tmp/tmp.b9qINNBHax
[Pipeline (hide)
[Pipeline] { (prod Inactive Stack  (hide)
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼Executing move_ecs_blue_green_canary_delete.sh.template
[Pipeline] fil (hide)
[Pipel (hide)
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_stack_delete.py --stack_name listhub-prod-canary --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole
[38;21m2020-12-01 21:11:45,289 Stack listhub-prod-canary does not exist.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼Executing move_ecs_blue_green_deploy_phase2_inactive_stack_deploy.sh.template
[Pipeline] fil (hide)
[Pipel (hide)
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼++ mktemp
+ CF_TEMPLATE_PATH=/tmp/tmp.NeHHJH
++ mktemp
+ CF_PARAMS=/tmp/tmp.nDlMFA
+ trap finish EXIT
+ cat
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/create_ecs_service_cf_template.py --cloudformation_template /usr/local/aws-deploy-tools/templates/ecs-service-alb-cloudformation.template --deploy_config_dir deployment --output /tmp/tmp.NeHHJH --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_simple_deploy.py --stack_name listhub-prod-green --cf_template_path /tmp/tmp.NeHHJH --params_path /tmp/tmp.nDlMFA --remove_stack_if_broken --ecs_cluster listhub-web-ecs-cluster --ecs_service_name listhub-prod-green --extra_tag Name=listhub-prod owner=sysadmin@listhub.com product=listhub component=app environment=prod --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
[38;21m2020-12-01 21:11:57,812 Rendered CloudFormation parameters:
ServiceName: "listhub-prod-green"
Hostname: "i-app.listhub.moveaws.com"
AlbPriority: "25800"
HealthCheckIntervalSeconds: ""
HealthCheckTimeoutSeconds: ""

[38;21m2020-12-01 21:11:57,816 Rendered CloudFormation template:
# CloudFormation template for ECS blue / green deployments. This template uses Mustache (or one of
# its derivities, like Pystache) to inject the following values:
#
# - ecsCluster - The name of the ECS cluster to deploy the service into.
#
# - ecsDeployMaxPercent - Optional. The MaximumPercent field.
#                         https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-deploymentconfiguration.html
#
# - ecsDeployMinHealthyPercent - Optional. The MinimumHealthyPercent field.
#                                https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-deploymentconfiguration.html
#
# - ecsDistinctInstancePlacementConstraint - Optional. Whether or not to enable a distinctInstance
#                                            placement constraint.
#                                            https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-placementconstraints-placementconstraint.html
#
# -  ecsMemberOfPlacementConstraint - Optional. Cluster Query Language to contrain deployments.
#                                            https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-placementconstraint.html
# 
#
# - ecsSpreadAzPlacementStrategy - Optional. Whether or not to spread containers across AZs
#                                  as a placement strategy.
#                                  https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-placementstrategies-placementstrategy.html
#
# - ecsSpreadInstanceIdPlacementStrategy - Optional. Whether or not to spread containers across
#                                          instances as a placement strategy.
#                                          https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-placementstrategies-placementstrategy.html
#
# - ecsServiceScaleDownAdjustment
# - ecsServiceScaleDownCompOp
# - ecsServiceScaleDownEvalPeriods
# - ecsServiceScaleDownMetric
# - ecsServiceScaleDownNamespace
# - ecsServiceScaleDownStatistic
# - ecsServiceScaleDownThreshold
# - ecsServiceScaleUpAdjustment
# - ecsServiceScaleUpCompOp
# - ecsServiceScaleUpEvalPeriods
# - ecsServiceScaleUpMetric
# - ecsServiceScaleUpNamespace
# - ecsServiceScaleUpStatistic
# - ecsServiceScaleUpThreshold - Optional. Autoscaling properties for the
#                                AWS::ApplicationAutoScaling::ScalableTarget and
#                                AWS::ApplicationAutoScaling::ScalingPolicy.
#
# - envName  - The name of the ECS canary service. This is only used for the CloudFormation
#              template description.
#
# - healthCheckHttpCode - The expected HTTP status code from the health check endpoint.
#                         https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-targetgroup.html
#
# - healthCheckUrl - The relative path of the health check URL.
#                         https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-targetgroup.html
#
# - httpListenerExport
# - httpsListenerExport - The ARN of the HTTP/HTTPS listeners on the ALB. This is typically the
#                         CloudFormation export ${ECS_CLUSTER}-${ALB_SCHEME}-http-listener,
#                         where ALB_SCHEME is either internal or internet_facing. See the
#                         ECS Cluster CloudFormation template in this repo for the export.
#                         https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html
#
# - iamRoleArn - Optional. An existing IAM role ARN that will be used as the ECS task role.
#                If you specify this, then do not specify iamTaskPolicy.
#
# - iamTaskPolicy - Optional. Create a new IAM role for the ECS task role. This is the policy
#                   document for the AWS::IAM::Role CloudFormation resource.
#
# - mainContainerName
# - mainContainerPort - The container name and container port that will receive traffic from the ALB
#                       https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-loadbalancers.html
#
# - minCapacity
# - maxCapacity - The min/max capacity for the ECS service application autoscaling group.
#                 https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-applicationautoscaling-scalabletarget.html
#
# - prevDesiredCount - The desired count for the ECS service. Typically, when we do a blue / green
#                      deployment, the deployment pipeline gets the desired count of
#
# - targetGroupDeregistrationDelay - The target group deregistration delay.
#                                    https://docs.aws.amazon.com/elasticloadbalancing/latest/APIReference/API_TargetGroupAttribute.html
#
# - targetGroupLbCookieDurationSecs
# - targetGroupStickinessEnabled - Whether or not session stickiness is enabled at the ALB and how
#                                  long the session tokens should live.
#                                  https://docs.aws.amazon.com/elasticloadbalancing/latest/APIReference/API_TargetGroupAttribute.html
#
# - taskDefinitionYaml - The AWS::ECS::TaskDefinition CloudFormation configuration. This is
#                        embedded within Move's projects in the deployment/Dockerrun.aws.yml
#                        file.
#                        https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html


Description: listhub-prod ECS service.

Parametrs:
  â€‹ServiceNam:
    â€‹Type: Strig
    â€‹Description: ECS service nme

  â€‹HealthCheckIntervalSecond:
    â€‹Type: Strig
    â€‹Description: Seconds between healthchecs
    â€‹Default:30

  â€‹HealthCheckTimeoutSecond:
    â€‹Type: Strig
    â€‹Description: Seconds during which no response from a target means a failed healthchek
    â€‹Default 5

  â€‹Hostnam:
    â€‹Type: Strig
    â€‹Description: Hostname 1 for the LB

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 2 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 3 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 4 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 5 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 6 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 7 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 8 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname:
    â€‹Type: Strig
    â€‹Description: Optional hostname 9 for the AL.
    â€‹Default: "unused.internl"

  â€‹Hostname1:
    â€‹Type: Strig
    â€‹Description: Optional hostname 10 for the AL.
    â€‹Default: "unused.internl"

  â€‹AlbPriorit:
    â€‹Type: Numbr
    â€‹Description: ALB priorit 1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 2. Requires Hostname2 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 3. Requires Hostname3 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 4. Requires Hostname4 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 5. Requires Hostname5 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 6. Requires Hostname6 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 7. Requires Hostname7 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 8. Requires Hostname8 to not be empy
    â€‹Default:-1

  â€‹AlbPriority:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 9. Requires Hostname9 to not be empy
    â€‹Default:-1

  â€‹AlbPriority1:
    â€‹Type: Numbr
    â€‹Description: Optional ALB priority 10. Requires Hostname10 to not be empy
    â€‹Default:-1

  â€‹NewTargetGroupWeigh:
    â€‹Type: Numbr
    â€‹Description: Weight for the new target grop
    â€‹MinValue:0
    â€‹MaxValue: 10
    â€‹Default: 00

  â€‹PrevTargetGroupWeigh:
    â€‹Type: Numbr
    â€‹Description: Weight for the previous target grop
    â€‹MinValue:0
    â€‹MaxValue: 10
    â€‹Default: 0

Conditins:
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam2 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam3 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam4 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam5 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam6 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam7 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam8 ]
  â€‹HasHostname:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostnam9 ]
  â€‹HasHostname1:
    â€‹Fn::No:
    â€‹- !Equals [ "unused.internal", !Ref Hostname0 ]
  â€‹WeightedBlueGreen: !Not [ !Equals [!Ref PrevTargetGroupWeight, 0] ]

Resoures:
  â€‹Servic:
    â€‹Type: AWS::ECS::Servie
    â€‹DependsOn:      â€‹- EcsServiceRole      â€‹- HttpsListenerRule      â€‹- TargetGroup      â€‹- TaskRoe
    â€‹Properties:      â€‹ServiceName: !Ref ServiceName      â€‹Cluster: listhub-web-ecs-cluster      â€‹Role: !Ref EcsServiceRole      â€‹DesiredCount: 4      â€‹TaskDefinition: !Ref TaskDefinition      â€‹PlacementStrategies:
       â€‹- Type: spread
         â€‹Field: attribute:ecs.availability-zone
       â€‹- Type: spread
         â€‹Field: instanceId      â€‹LoadBalancers:
       â€‹- ContainerName: listhub
         â€‹ContainerPort: 8080
         â€‹TargetGroupArn: !Ref TargetGrup

  â€‹ServiceScalingTarge:
    â€‹Type: AWS::ApplicationAutoScaling::ScalableTargt
    â€‹DependsOn: Servie
    â€‹Properties:      â€‹MinCapacity: 4      â€‹MaxCapacity: 8      â€‹ResourceId: !Join ['', [service/listhub-web-ecs-cluster, /, !GetAtt [Service, Name]]]      â€‹RoleARN: !GetAtt [AutoscalingRole, Arn]      â€‹ScalableDimension: ecs:service:DesiredCount      â€‹ServiceNamespace: cs

  â€‹AutoscalingRol:
    â€‹Type: AWS::IAM::Roe
    â€‹Properties:      â€‹PermissionsBoundary: !Join ["", [ 'arn:aws:iam::', !Ref 'AWS::AccountId', ':policy/CloudServices-Boundary' ]]      â€‹AssumeRolePolicyDocument:
       â€‹Statement:
       â€‹- Effect: Allow
         â€‹Principal:
           â€‹Service:
             â€‹- application-autoscaling.amazonaws.com
         â€‹Action:
           â€‹- sts:AssumeRole      â€‹Path: /      â€‹ManagedPolicyArns:
       â€‹- arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceAutoscaleRole      â€‹Policies:
       â€‹- PolicyName: service-autoscaling
         â€‹PolicyDocument:
           â€‹Version: "2012-10-17"
           â€‹Statement:
             â€‹- Effect: Allow
               â€‹Action:
                 â€‹- application-autoscaling:*
                 â€‹- cloudwatch:DescribeAlarms
                 â€‹- cloudwatch:PutMetricAlarm
               â€‹Resource:
                 â€‹- *"

  â€‹ServiceScaleUpPolic:
    â€‹Type: AWS::ApplicationAutoScaling::ScalingPoliy
    â€‹Properties:      â€‹PolicyName: !Sub ${AWS::StackName}-scale-up-policy      â€‹PolicyType: StepScaling      â€‹ScalingTargetId: !Ref 'ServiceScalingTarget'      â€‹StepScalingPolicyConfiguration:
       â€‹AdjustmentType: ChangeInCapacity
       â€‹Cooldown: 300
       â€‹MetricAggregationType: Maximum
       â€‹StepAdjustments:
         â€‹- MetricIntervalLowerBound: 0
           â€‹ScalingAdjustment 1

  â€‹ServiceScaleDownPolic:
    â€‹Type: AWS::ApplicationAutoScaling::ScalingPoliy
    â€‹Properties:      â€‹PolicyName: !Sub ${AWS::StackName}-scale-down-policy      â€‹PolicyType: StepScaling      â€‹ScalingTargetId: !Ref 'ServiceScalingTarget'      â€‹StepScalingPolicyConfiguration:
       â€‹AdjustmentType: ChangeInCapacity
       â€‹Cooldown: 300
       â€‹MetricAggregationType: Maximum
       â€‹StepAdjustments:
         â€‹- MetricIntervalUpperBound: 0
           â€‹ScalingAdjustment:-1

  â€‹ScaleU:
    â€‹Type: AWS::CloudWatch::Alam
    â€‹Properties:      â€‹EvaluationPeriods: '5'      â€‹Statistic: Average      â€‹AlarmDescription: Alarm if CPUUtilization is too high.      â€‹Period: '60'      â€‹AlarmActions: [!Ref 'ServiceScaleUpPolicy']      â€‹Threshold: '65'      â€‹ComparisonOperator: GreaterThanThreshold      â€‹Namespace: AWS/ECS      â€‹Dimensions:
       â€‹- Name: ClusterName
         â€‹Value: listhub-web-ecs-cluster
       â€‹- Name: ServiceName
         â€‹Value: !GetAtt [Service, Name]      â€‹MetricName: CPUUtilizaton

  â€‹ScaleDow:
    â€‹Type: AWS::CloudWatch::Alam
    â€‹Properties:      â€‹EvaluationPeriods: '15'      â€‹Statistic: Average      â€‹AlarmDescription: Alarm if CPUUtilization is too low.      â€‹Period: '60'      â€‹AlarmActions: [!Ref 'ServiceScaleDownPolicy']      â€‹Threshold: '40'      â€‹ComparisonOperator: LessThanThreshold      â€‹Namespace: AWS/ECS      â€‹Dimensions:
       â€‹- Name: ClusterName
         â€‹Value: listhub-web-ecs-cluster
       â€‹- Name: ServiceName
         â€‹Value: !GetAtt [Service, Name]      â€‹MetricName: CPUUtilizaton

  â€‹TaskDefinitio:
    â€‹Type: AWS::ECS::TaskDefinitin
    â€‹Properties:      â€‹TaskRoleArn: !Ref TaskRole      â€‹ContainerDefinitions:      â€‹- EntryPoint:
       â€‹- start-webapp
       â€‹Environment:
       â€‹- Name: CANARY_DEPLOYMENT
         â€‹Value: 'false'
       â€‹- Name: GIT_SHA
         â€‹Value: 5ecee24
       â€‹- Name: GIT_BRANCH
         â€‹Value: master
       â€‹- Name: BUILD_NUMBER
         â€‹Value: '371'
       â€‹- Name: JOB_NAME
         â€‹Value: listhub-prod-5ecee24
       â€‹- Name: profile
         â€‹Value: aws-us-east-1-production-web
       â€‹- Name: java_opts
         â€‹Value: -XX:MaxRAM=7168m -javaagent:/usr/share/listhub/java/resources/newrelic/newrelic.jar
       â€‹- Name: LH_MONITORING_NEWRELIC_APP_NAME
         â€‹Value: listhub (prod)
       â€‹- Name: LH_MONITORING_NEWRELIC_LICENSE
         â€‹Value: 1db41a911da6aa096d827eea7fa11e00807dc58b
       â€‹- Name: VAULT_ENV
         â€‹Value: prod
       â€‹- Name: VAULT_ROLE
         â€‹Value: industryplatforms-listhub-prod-iam
       â€‹- Name: VAULT_PREFIX
         â€‹Value: kv/industryplatforms/listhub/prod
       â€‹Essential: true
       â€‹Image: docker.artifactory.moveaws.com/listhub/listhub:5ecee24
       â€‹LinuxParameters:
         â€‹InitProcessEnabled: 'true'
       â€‹LogConfiguration:
         â€‹LogDriver: splunk
         â€‹Options:
           â€‹mode: non-blocking
           â€‹splunk-format: raw
           â€‹splunk-insecureskipverify: 'true'
           â€‹splunk-source: docker
           â€‹splunk-sourcetype: listhub-prod
           â€‹splunk-token: 28016449-F03D-4597-BB18-9CD98DD83EEL
           â€‹splunk-url: https://splunk-hf2.moveaws.com:8088
           â€‹splunk-verify-connection: 'false'
           â€‹tag: ''
       â€‹Memory: '7168'
       â€‹MountPoints:
       â€‹- ContainerPath: /tmp/reportsv2
         â€‹SourceVolume: report_cache
       â€‹Name: listhub
       â€‹PortMappings:
       â€‹- ContainerPort: '8080'      â€‹Volumes:      â€‹- Host:
         â€‹SourcePath: /tmp/listhub-prod-report-cache
       â€‹Name: report_cache     â€‹

  â€‹TargetGrou:
    â€‹Type: AWS::ElasticLoadBalancingV2::TargetGrop
    â€‹Properties:      â€‹VpcId:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-VPC"      â€‹Port: 80      â€‹Protocol: HTTP      â€‹Matcher:
       â€‹HttpCode: 200-299      â€‹HealthCheckIntervalSeconds: !Ref HealthCheckIntervalSeconds      â€‹HealthCheckPath: /servlet/status      â€‹HealthCheckProtocol: HTTP      â€‹HealthCheckTimeoutSeconds: !Ref HealthCheckTimeoutSeconds      â€‹HealthyThresholdCount: 2      â€‹UnhealthyThresholdCount: 5      â€‹TargetGroupAttributes:
       â€‹- Key: deregistration_delay.timeout_seconds
         â€‹Value: 60
       â€‹- Key: stickiness.enabled
         â€‹Value: true
       â€‹- Key: stickiness.lb_cookie.duration_seconds
         â€‹Value: 8600

  â€‹HttpRedirectListenerRul:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam2
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority2      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname2      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam3
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority3      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname3      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam4
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority4      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname4      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam5
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority5      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname5      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam6
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority6      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname6      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam7
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority7      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname7      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam8
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority8      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname8      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam9
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority9      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname9      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_01

  â€‹HttpRedirectListenerRule1:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostname0
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-http-listener"      â€‹Priority: !Ref AlbPriority10      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname10      â€‹Actions:
       â€‹- Type: redirect
         â€‹RedirectConfig:
           â€‹Host: "app.listhub.com"
           â€‹Path: "/#{path}"
           â€‹Port: 443
           â€‹Protocol: HTTPS
           â€‹StatusCode: HTTP_31


  â€‹HttpsListenerRul:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam2
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority2      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname2      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam3
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority3      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname3      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam4
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority4      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname4      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam5
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority5      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname5      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam6
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority6      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname6      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam7
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority7      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname7      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam8
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority8      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname8      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostnam9
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority9      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname9      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹HttpsListenerRule1:
    â€‹Type: AWS::ElasticLoadBalancingV2::ListenerRue
    â€‹Condition: HasHostname0
    â€‹Properties:      â€‹ListenerArn:
       â€‹'Fn::ImportValue': "listhub-web-ecs-cluster-internet-facing-https-listener"      â€‹Priority: !Ref AlbPriority10      â€‹Conditions:
       â€‹- Field: host-header
         â€‹Values:
           â€‹- !Ref Hostname10      â€‹Actions:
       â€‹- Type: forward
         â€‹ForwardConfig:
           â€‹TargetGroups:
             â€‹- TargetGroupArn: !Ref TargetGroup
               â€‹Weight: !Ref NewTargetGroupWeight
             â€‹- !If
               â€‹- WeightedBlueGreen
               â€‹-
                 â€‹TargetGroupArn:
                   â€‹'Fn::ImportValue': 'listhub-prod-blue-tg'
                 â€‹Weight: !Ref PrevTargetGroupWeight
               â€‹- !Ref "AWS::NoValue"
           â€‹TargetGroupStickinessConfig:
             â€‹DurationSeconds: 2000
             â€‹Enabled: tue

  â€‹# This IAM Role grants the service access to register/unregister withthe
  â€‹# Application Load Balancer (ALB). It is based on the default documented hre:
  â€‹# http://docs.aws.amazon.com/AmazonECS/latest/developerguide/service_IAM_role.tml
  â€‹EcsServiceRol:
    â€‹Type: AWS::IAM::Roe
    â€‹Properties:      â€‹PermissionsBoundary: !Join ["", [ 'arn:aws:iam::', !Ref 'AWS::AccountId', ':policy/CloudServices-Boundary' ]]      â€‹RoleName: !Sub svc-${AWS::StackName}      â€‹Path: /      â€‹AssumeRolePolicyDocument:
       â€‹Version: "2012-10-17"
       â€‹Statement:
         â€‹- Effect: Allow
           â€‹Principal:
             â€‹Service:
               â€‹- ecs.amazonaws.com
           â€‹Action:
             â€‹- sts:AssumeRole      â€‹ManagedPolicyArns:
       â€‹- arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceRle

  â€‹TaskRol:
    â€‹Type: AWS::IAM::Roe
    â€‹Properties:      â€‹PermissionsBoundary: !Join ["", [ 'arn:aws:iam::', !Ref 'AWS::AccountId', ':policy/CloudServices-Boundary' ]]      â€‹RoleName: !Sub svc-${AWS::StackName}-role      â€‹Path: /      â€‹AssumeRolePolicyDocument:
       â€‹Version: "2012-10-17"
       â€‹Statement:
         â€‹- Effect: Allow
           â€‹Principal:
             â€‹Service:
               â€‹- ecs-tasks.amazonaws.com
           â€‹Action:
             â€‹- sts:AssumeRole      â€‹Policies:
       â€‹- PolicyName: !Sub svc-${AWS::StackName}
         â€‹PolicyDocument:
           â€‹Version: "2012-10-17"
           â€‹Statement:
             â€‹- Action: '*'
               â€‹Effect: Allow
               â€‹Resource: '*'
           â€‹

Outpts:
  â€‹TargetGroupAr:
    â€‹Description: Target Group AN
    â€‹Value: !Ref TargetGrop
    â€‹Export:      â€‹Name: !Sub ${AWS::StackName}-tg

[38;21m2020-12-01 21:11:57,816 Deploying stack listhub-prod-green.
[38;21m2020-12-01 21:11:57,816 stack_params: [{'ParameterKey': 'ServiceName', 'ParameterValue': 'listhub-prod-green'}, {'ParameterKey': 'Hostname', 'ParameterValue': 'i-app.listhub.moveaws.com'}, {'ParameterKey': 'AlbPriority', 'ParameterValue': '25800'}, {'ParameterKey': 'HealthCheckIntervalSeconds', 'ParameterValue': ''}, {'ParameterKey': 'HealthCheckTimeoutSeconds', 'ParameterValue': ''}]
[38;21m2020-12-01 21:12:14,615    listhub-prod-green: CREATE_IN_PROGRESS User Initiated
[38;21m2020-12-01 21:12:22,610    EcsServiceRole: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:22,610    TargetGroup: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:22,610    HttpRedirectListenerRule: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:22,610    AutoscalingRole: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:22,610    TaskRole: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:22,610    TargetGroup: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:22,610    HttpRedirectListenerRule: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:22,611    AutoscalingRole: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:22,611    EcsServiceRole: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:22,611    TargetGroup: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:22,611    TaskRole: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:22,611    HttpRedirectListenerRule: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:22,611    HttpsListenerRule: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:22,611    HttpsListenerRule: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:22,611    HttpsListenerRule: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:29,779    EcsServiceRole: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:29,779    AutoscalingRole: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:38,369    TaskRole: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:38,369    TaskDefinition: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:38,369    TaskDefinition: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:38,369    TaskDefinition: CREATE_COMPLETE 
[38;21m2020-12-01 21:12:45,853    Service: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:12:45,853    Service: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:12:45,853   (ECS-SVC) (service listhub-prod-green) has started 4 tasks: (task 8e7dbce9d8894002aad56ed2f02731e2) (task d9acec4d2ec7461b9aa4dc93b2dc2878) (task e50826539a254657ab15a2ceb9c73500) (task 0fe0b37a36a045d2822a80ff8a11c4b9).
[38;21m2020-12-01 21:12:45,853   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/0fe0b37a36a045d2822a80ff8a11c4b9: PENDING -> RUNNING Containers=[listhub: PENDING]
[38;21m2020-12-01 21:12:45,853   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/8e7dbce9d8894002aad56ed2f02731e2: PENDING -> RUNNING Containers=[listhub: PENDING]
[38;21m2020-12-01 21:12:45,853   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/d9acec4d2ec7461b9aa4dc93b2dc2878: PENDING -> RUNNING Containers=[listhub: PENDING]
[38;21m2020-12-01 21:12:45,853   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/e50826539a254657ab15a2ceb9c73500: PENDING -> RUNNING Containers=[listhub: PENDING]
[38;21m2020-12-01 21:13:40,000   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/e50826539a254657ab15a2ceb9c73500: RUNNING Containers=[listhub: RUNNING]
[38;21m2020-12-01 21:13:47,971   (ECS-SVC) (service listhub-prod-green) registered 2 targets in (target-group arn:aws:elasticloadbalancing:us-east-1:104222541211:targetgroup/listh-Targe-RISRPDAFS4X5/f87e3c3f0738baec)
[38;21m2020-12-01 21:13:47,971   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/0fe0b37a36a045d2822a80ff8a11c4b9: RUNNING Containers=[listhub: RUNNING]
[38;21m2020-12-01 21:14:02,973    Service: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:02,973   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/8e7dbce9d8894002aad56ed2f02731e2: RUNNING Containers=[listhub: RUNNING]
[38;21m2020-12-01 21:14:02,973   (ECS) arn:aws:ecs:us-east-1:104222541211:task/listhub-web-ecs-cluster/d9acec4d2ec7461b9aa4dc93b2dc2878: RUNNING Containers=[listhub: RUNNING]
[38;21m2020-12-01 21:14:10,603    ServiceScalingTarget: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:14:10,603    ServiceScalingTarget: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:14:10,603    ServiceScalingTarget: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:18,054    ServiceScaleDownPolicy: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:14:18,054    ServiceScaleUpPolicy: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:14:18,054    ServiceScaleDownPolicy: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:14:18,054    ServiceScaleUpPolicy: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:14:18,054    ServiceScaleDownPolicy: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:18,055    ServiceScaleUpPolicy: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:18,055    ScaleDown: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:14:18,055    ScaleDown: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:14:18,055    ScaleUp: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:14:18,055    ScaleDown: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:18,055    ScaleUp: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:14:18,055    ScaleUp: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:25,892    listhub-prod-green: CREATE_COMPLETE 
[38;21m2020-12-01 21:14:26,207 Finished CF deployment in 0:02:32.477224.
INFO: We have not crossed any service limits for CloudFormation
INFO: Skipping Terminate Protect as flag is not set
+ finish
+ rm -f /tmp/tmp.NeHHJH /tmp/tmp.nDlMFA
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryR (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipeline] archiveAr hide)
ï¿¼Archiving artifacts
[Pipel hide)
ï¿¼+ rm /tmp/tmp.g0OPX7vVtT
[Pipelin hide)
ï¿¼Giving the containers a few seconds to start up before running tests.
[Pipeline hide)
ï¿¼Sleeping for 5 sec
[Pipeline (hide)
[Pipeline] { (prod Inactive Stac (hide)
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipel hide)
ï¿¼+ jenkins-hooks/integration-tests.sh i-app.listhub.moveaws.com
+ BASE_URL=i-app.listhub.moveaws.com
+ docker run --rm appropriate/curl -f -v -L i-app.listhub.moveaws.com/servlet/status
Unable to find image 'appropriate/curl:latest' locally
latest: Pulling from appropriate/curl
ff3a5c916c92: Pulling fs layer
3151abf94102: Pulling fs layer
58ae3cb4aac4: Pulling fs layer
58ae3cb4aac4: Verifying Checksum
58ae3cb4aac4: Download complete
3151abf94102: Download complete
ff3a5c916c92: Download complete
ff3a5c916c92: Pull complete
3151abf94102: Pull complete
58ae3cb4aac4: Pull complete
Digest: sha256:c8bf5bbec6397465a247c2bb3e589bb77e4f62ff88a027175ecb2d9e4f12c9d7
Status: Downloaded newer image for appropriate/curl:laest
  â€‹% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                â€‹Dload  Upload   Total   Spent    Left  Sped

  â€‹0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 52.54.247.183...
* TCP_NODELAY set
* Connected to i-app.listhub.moveaws.com (52.54.247.183) port 80 (#0)
> GET /servlet/status HTTP/1.1
> Host: i-app.listhub.moveaws.com
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Server: awselb/2.0
< Date: Tue, 01 Dec 2020 21:14:41 GMT
< Content-Type: text/html
< Content-Length: 134
< Connection: keep-alive
< Location: https://app.listhub.com:443/servlet/status
< 
* Ignoring the response-body
{ [134 bytes data]

100   134  100   134    0     0    848      0 --:--:-- --:--:-- --:--:--   848
* Connection #0 to host i-app.listhub.moveaws.com left intact
* Issue another request to this URL: 'https://app.listhub.com:443/servlet/status'
*   Trying 107.21.76.62...
* TCP_NODELAY set
* Connected to app.listhub.com (107.21.76.62) port 443 (#1)
* ALPN, offering http/1.1
* successfully set certificate verify locatins:
  â€‹CAfile: /etc/ssl/certs/ca-certificatescrt
  â€‹CApath: none
* TLSv1.2 (OUT), TLS handshake, Client hello (1):
} [230 bytes data]
* TLSv1.2 (IN), TLS handshake, Server hello (2):
{ [104 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4890 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Client hello (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Client hello (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256
* ALPN, server accepted to use http/1.1
* Server certificate:
*  subject: CN=*.listhub.com
*  start date: Aug 29 00:00:00 2020 GMT
*  expire date: Sep 29 12:00:00 2021 GMT
*  subjectAltName: host "app.listhub.com" matched cert's "*.listhub.com"
*  issuer: C=US; O=Amazon; OU=Server CA 1B; CN=Amazon
*  SSL certificate verify ok.
> GET /servlet/status HTTP/1.1
> Host: app.listhub.com
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 200 OK
< Date: Tue, 01 Dec 2020 21:14:42 GMT
< Transfer-Encoding: chunked
< Connection: keep-alive
< Set-Cookie: AWSALBTG=gxLa39QkMfD6IY5HArcY9BNltBBksxbRF+76u3uwhq1AA5FXlJgKeQfAq2NKZtokkqA3HGfPlbOkEBiCLqbsK9RLa7LIhtHxUYIJ2I+0cDrCBY+3utvrZI4XW7f2tOZtriImsKJTlihyMyBNqh6MxfWEVq1t1xNzM7cA86GzI5+t; Expires=Tue, 08 Dec 2020 21:14:42 GMT; Path=/
< Set-Cookie: AWSALBTGCORS=gxLa39QkMfD6IY5HArcY9BNltBBksxbRF+76u3uwhq1AA5FXlJgKeQfAq2NKZtokkqA3HGfPlbOkEBiCLqbsK9RLa7LIhtHxUYIJ2I+0cDrCBY+3utvrZI4XW7f2tOZtriImsKJTlihyMyBNqh6MxfWEVq1t1xNzM7cA86GzI5+t; Expires=Tue, 08 Dec 2020 21:14:42 GMT; Path=/; SameSite=None; Secure
< Set-Cookie: AWSALB=rtzstODuD/ldDf68IL6SdZz9tfBZKZuIkrCY/9mDxLyhkLvqDKVjV8+Hl+1zGI43Qg5Ro9WLEglvbggLH+pVryVGhHNf8tZVEotwellbJhY7Dj3eJzOTjqX2zOqV; Expires=Tue, 08 Dec 2020 21:14:42 GMT; Path=/
< Set-Cookie: AWSALBCORS=rtzstODuD/ldDf68IL6SdZz9tfBZKZuIkrCY/9mDxLyhkLvqDKVjV8+Hl+1zGI43Qg5Ro9WLEglvbggLH+pVryVGhHNf8tZVEotwellbJhY7Dj3eJzOTjqX2zOqV; Expires=Tue, 08 Dec 2020 21:14:42 GMT; Path=/; SameSite=None; Secure
< Server: Jetty(9.4.15.v20190215)
< 
{ [40 bytes data]

100    34    0    Application Successfully Verified
34    0     0     72      0 --:--:-- --:--:-- --:--:--    72
100    34    0    34    0     0     72      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host app.listhub.com left intact
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryR (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipeline] archiveAr hide)
ï¿¼Archiving artifacts
[Pipel hide)
ï¿¼+ rm /tmp/tmp.WopweTLgaa
[Pipeline (hide)
[Pipeline] { (prod Swap Target Group (hide)
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼Executing move_ecs_blue_green_deploy_phase3_swap_target_group_hosts.sh.template
[Pipeline] fil (hide)
[Pipel (hide)
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼++ mktemp
+ PARAMFILE=/tmp/tmp.OCdpMM
+ trap finish EXIT
+ cat
++ get_alb_hostname app.listhub.com unused.internal
++ '[' app.listhub.com '!=' '' ']'
++ echo app.listhub.com
++ get_alb_hostname app.listhub.net unused.internal
++ '[' app.listhub.net '!=' '' ']'
++ echo app.listhub.net
++ get_alb_hostname reports.listhub.com unused.internal
++ '[' reports.listhub.com '!=' '' ']'
++ echo reports.listhub.com
++ get_alb_hostname reports.listhub.net unused.internal
++ '[' reports.listhub.net '!=' '' ']'
++ echo reports.listhub.net
++ get_alb_hostname listings.listhub.com unused.internal
++ '[' listings.listhub.com '!=' '' ']'
++ echo listings.listhub.com
++ get_alb_hostname listings.listhub.net unused.internal
++ '[' listings.listhub.net '!=' '' ']'
++ echo listings.listhub.net
++ get_alb_hostname feeds.listhub.net unused.internal
++ '[' feeds.listhub.net '!=' '' ']'
++ echo feeds.listhub.net
++ get_alb_hostname feeds.listhub.com unused.internal
++ '[' feeds.listhub.com '!=' '' ']'
++ echo feeds.listhub.com
++ get_alb_hostname '' unused.internal
++ '[' '' '!=' '' ']'
++ echo unused.internal
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_simple_deploy.py --stack_name listhub-prod-green --params_path /tmp/tmp.OCdpMM --ecs_cluster listhub-web-ecs-cluster --ecs_service_name '' --strip_missing_parameters --extra_tag Name=listhub-prod owner=sysadmin@listhub.com product=listhub component=app environment=prod --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
[38;21m2020-12-01 21:15:01,019 Rendered CloudFormation parameters:
ServiceName: "listhub-prod-green"
Hostname: "app.listhub.moveaws.com"
Hostname2: "app.listhub.com"
Hostname3: "app.listhub.net"
Hostname4: "reports.listhub.com"
Hostname5: "reports.listhub.net"
Hostname6: "listings.listhub.com"
Hostname7: "listings.listhub.net"
Hostname8: "feeds.listhub.net"
Hostname9: "feeds.listhub.com"
Hostname10: "unused.internal"
AlbPriority: "25800"
AlbPriority2: "31608"
AlbPriority3: "16224"
AlbPriority4: "39772"
AlbPriority5: "43980"
AlbPriority6: "42554"
AlbPriority7: "17378"
AlbPriority8: "28544"
AlbPriority9: "49618"
AlbPriority10: "-1"
HealthCheckIntervalSeconds: ""
HealthCheckTimeoutSeconds: ""

[38;21m2020-12-01 21:15:01,131 Deploying stack listhub-prod-green.
[38;21m2020-12-01 21:15:01,131 stack_params: [{'ParameterKey': 'ServiceName', 'ParameterValue': 'listhub-prod-green'}, {'ParameterKey': 'Hostname', 'ParameterValue': 'app.listhub.moveaws.com'}, {'ParameterKey': 'Hostname2', 'ParameterValue': 'app.listhub.com'}, {'ParameterKey': 'Hostname3', 'ParameterValue': 'app.listhub.net'}, {'ParameterKey': 'Hostname4', 'ParameterValue': 'reports.listhub.com'}, {'ParameterKey': 'Hostname5', 'ParameterValue': 'reports.listhub.net'}, {'ParameterKey': 'Hostname6', 'ParameterValue': 'listings.listhub.com'}, {'ParameterKey': 'Hostname7', 'ParameterValue': 'listings.listhub.net'}, {'ParameterKey': 'Hostname8', 'ParameterValue': 'feeds.listhub.net'}, {'ParameterKey': 'Hostname9', 'ParameterValue': 'feeds.listhub.com'}, {'ParameterKey': 'Hostname10', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'AlbPriority', 'ParameterValue': '25800'}, {'ParameterKey': 'AlbPriority2', 'ParameterValue': '31608'}, {'ParameterKey': 'AlbPriority3', 'ParameterValue': '16224'}, {'ParameterKey': 'AlbPriority4', 'ParameterValue': '39772'}, {'ParameterKey': 'AlbPriority5', 'ParameterValue': '43980'}, {'ParameterKey': 'AlbPriority6', 'ParameterValue': '42554'}, {'ParameterKey': 'AlbPriority7', 'ParameterValue': '17378'}, {'ParameterKey': 'AlbPriority8', 'ParameterValue': '28544'}, {'ParameterKey': 'AlbPriority9', 'ParameterValue': '49618'}, {'ParameterKey': 'AlbPriority10', 'ParameterValue': '-1'}, {'ParameterKey': 'HealthCheckIntervalSeconds', 'ParameterValue': ''}, {'ParameterKey': 'HealthCheckTimeoutSeconds', 'ParameterValue': ''}]
[38;21m2020-12-01 21:15:17,795    listhub-prod-green: UPDATE_IN_PROGRESS User Initiated
[38;21m2020-12-01 21:15:25,799    HttpsListenerRule6: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,799    HttpsListenerRule4: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,799    HttpRedirectListenerRule: UPDATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,799    HttpsListenerRule6: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,799    HttpsListenerRule2: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,799    HttpRedirectListenerRule8: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,799    HttpRedirectListenerRule: UPDATE_COMPLETE 
[38;21m2020-12-01 21:15:25,799    HttpsListenerRule4: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule9: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule4: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule5: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule2: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule2: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule9: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule6: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule8: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule3: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule3: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule: UPDATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule5: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule7: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule5: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule4: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule4: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule2: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule9: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule8: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule7: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,800    HttpsListenerRule: UPDATE_COMPLETE 
[38;21m2020-12-01 21:15:25,800    HttpRedirectListenerRule9: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule2: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule3: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule5: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule8: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule7: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule6: CREATE_IN_PROGRESS 
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule5: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule8: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule9: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule7: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule2: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule4: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule6: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule3: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule7: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule8: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule9: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule5: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule7: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpRedirectListenerRule6: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule3: CREATE_IN_PROGRESS Resource creation Initiated
[38;21m2020-12-01 21:15:25,801    HttpsListenerRule3: CREATE_COMPLETE 
[38;21m2020-12-01 21:15:33,176    listhub-prod-green: UPDATE_COMPLETE_CLEANUP_IN_PROGRESS 
[38;21m2020-12-01 21:15:33,176    listhub-prod-green: UPDATE_COMPLETE 
[38;21m2020-12-01 21:15:33,394 Finished CF deployment in 0:00:36.589273.
INFO: Skipping Terminate Protect as flag is not set
+ cat
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_simple_deploy.py --stack_name listhub-prod-blue --params_path /tmp/tmp.OCdpMM --ecs_cluster listhub-web-ecs-cluster --ecs_service_name '' --strip_missing_parameters --extra_tag Name=listhub-prod owner=sysadmin@listhub.com product=listhub component=app environment=prod --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
[38;21m2020-12-01 21:15:37,983 Rendered CloudFormation parameters:
ServiceName: "listhub-prod-blue"
Hostname: "i-app.listhub.moveaws.com"
Hostname2: "unused.internal"
Hostname3: "unused.internal"
Hostname4: "unused.internal"
Hostname5: "unused.internal"
Hostname6: "unused.internal"
Hostname7: "unused.internal"
Hostname8: "unused.internal"
Hostname9: "unused.internal"
Hostname10: "unused.internal"
AlbPriority: "27206"
AlbPriority2: "35309"
AlbPriority3: "18301"
AlbPriority4: "18219"
AlbPriority5: "29194"
AlbPriority6: "45271"
AlbPriority7: "47378"
AlbPriority8: "31570"
AlbPriority9: "15697"
AlbPriority10: "-1"
HealthCheckIntervalSeconds: ""
HealthCheckTimeoutSeconds: ""

[38;21m2020-12-01 21:15:38,091 Deploying stack listhub-prod-blue.
[38;21m2020-12-01 21:15:38,091 stack_params: [{'ParameterKey': 'ServiceName', 'ParameterValue': 'listhub-prod-blue'}, {'ParameterKey': 'Hostname', 'ParameterValue': 'i-app.listhub.moveaws.com'}, {'ParameterKey': 'Hostname2', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname3', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname4', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname5', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname6', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname7', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname8', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname9', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'Hostname10', 'ParameterValue': 'unused.internal'}, {'ParameterKey': 'AlbPriority', 'ParameterValue': '27206'}, {'ParameterKey': 'AlbPriority2', 'ParameterValue': '35309'}, {'ParameterKey': 'AlbPriority3', 'ParameterValue': '18301'}, {'ParameterKey': 'AlbPriority4', 'ParameterValue': '18219'}, {'ParameterKey': 'AlbPriority5', 'ParameterValue': '29194'}, {'ParameterKey': 'AlbPriority6', 'ParameterValue': '45271'}, {'ParameterKey': 'AlbPriority7', 'ParameterValue': '47378'}, {'ParameterKey': 'AlbPriority8', 'ParameterValue': '31570'}, {'ParameterKey': 'AlbPriority9', 'ParameterValue': '15697'}, {'ParameterKey': 'AlbPriority10', 'ParameterValue': '-1'}, {'ParameterKey': 'HealthCheckIntervalSeconds', 'ParameterValue': ''}, {'ParameterKey': 'HealthCheckTimeoutSeconds', 'ParameterValue': ''}]
[38;21m2020-12-01 21:15:55,215    listhub-prod-blue: UPDATE_IN_PROGRESS User Initiated
[38;21m2020-12-01 21:16:03,341    HttpsListenerRule: UPDATE_IN_PROGRESS 
[38;21m2020-12-01 21:16:03,341    HttpsListenerRule: UPDATE_COMPLETE 
[38;21m2020-12-01 21:16:03,341    HttpRedirectListenerRule: UPDATE_IN_PROGRESS 
[38;21m2020-12-01 21:16:03,341    HttpRedirectListenerRule: UPDATE_COMPLETE 
[38;21m2020-12-01 21:16:10,965    listhub-prod-blue: UPDATE_COMPLETE_CLEANUP_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule2: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule2: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule4: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule5: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule7: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule9: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule3: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule7: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule6: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule6: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule8: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule8: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpRedirectListenerRule4: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,965    HttpsListenerRule3: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule9: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule5: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule3: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule9: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule4: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule8: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule5: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule7: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule8: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule2: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule4: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule7: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule9: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule5: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule6: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule6: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpsListenerRule3: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    HttpRedirectListenerRule2: DELETE_COMPLETE 
[38;21m2020-12-01 21:16:10,966    listhub-prod-blue: UPDATE_COMPLETE 
[38;21m2020-12-01 21:16:11,181 Finished CF deployment in 0:00:37.535884.
INFO: Skipping Terminate Protect as flag is not set
+ finish
+ rm -f /tmp/tmp.OCdpMM
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipel hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipel hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] http (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] libraryR (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipel (hide)
[Pipeline] archiveAr hide)
ï¿¼Archiving artifacts
[Pipel hide)
ï¿¼+ rm /tmp/tmp.lj8G4TvGps
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼Executing move_new_relic_notify.template
[Pipeline] fil (hide)
[Pipel (hide)
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼Skipping New Relic deployment notification since the newRelicAppId variable is not set.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] an (hide)
[Pipe (hide)
[Pipelin hide)
ï¿¼Executing move_sns_send.sh.template
[Pipeline] fil (hide)
[Pipel (hide)
[Pipeline] wr (hide)
[Pipeline] wr (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel (hide)
[Pipel (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipel hide)
ï¿¼Skipping SNS notification since a topic ARN is not configured.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // node
[Pipelin hide)
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[Pipe (hide)
[Pipeline] c hide)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching withouttags
 â€‹> git rev-parse --is-inside-work-tree # timeot=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/listhu.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key from mster
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origin/master
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-1784'"
[Pipeline (hide)
[Pipeline] { (prod Smok (hide)
[Pipel hide)
ï¿¼ â€‹> git config core.sparsecheckout # timeut=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc4675557b7
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipeh(hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] httt (hide)
[Pipeline] ar (hide)
[Pip{ (hide)
[Pipelio(hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipelinp(hide)
ï¿¼Sleeping for 1 sec
[Pipeh(hide)
ï¿¼+ jenkins-hooks/smoke-tests.sh app.listhub.moveaws.com
+ BASE_URL=app.listhub.moveaws.com
+ docker run --rm appropriate/curl -f -v -L app.listhub.moveaws.com/servlet/satus
  â€‹% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                â€‹Dload  Upload   Total   Spent    Left  Seed

  â€‹0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 52.54.247.183...
* TCP_NODELAY set
* Connected to app.listhub.moveaws.com (52.54.247.183) port 80 (#0)
> GET /servlet/status HTTP/1.1
> Host: app.listhub.moveaws.com
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Server: awselb/2.0
< Date: Tue, 01 Dec 2020 21:16:35 GMT
< Content-Type: text/html
< Content-Length: 134
< Connection: keep-alive
< Location: https://app.listhub.com:443/servlet/status
< 
* Ignoring the response-body
{ [134 bytes data]

100   134  100   134    0     0    937      0 --:--:-- --:--:-- --:--:--   930
100   134  100   134    0     0    937      0 --:--:-- --:--:-- --:--:--   930
* Connection #0 to host app.listhub.moveaws.com left intact
* Issue another request to this URL: 'https://app.listhub.com:443/servlet/status'
*   Trying 52.54.247.183...
* TCP_NODELAY set
* Connected to app.listhub.com (52.54.247.183) port 443 (#1)
* ALPN, offering http/1.1
* successfully set certificate verify locatons:
  â€‹CAfile: /etc/ssl/certs/ca-certificate.crt
  â€‹CApath: none
* TLSv1.2 (OUT), TLS handshake, Client hello (1):
} [230 bytes data]
* TLSv1.2 (IN), TLS handshake, Server hello (2):
{ [104 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4890 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Client hello (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Client hello (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256
* ALPN, server accepted to use http/1.1
* Server certificate:
*  subject: CN=*.listhub.com
*  start date: Aug 29 00:00:00 2020 GMT
*  expire date: Sep 29 12:00:00 2021 GMT
*  subjectAltName: host "app.listhub.com" matched cert's "*.listhub.com"
*  issuer: C=US; O=Amazon; OU=Server CA 1B; CN=Amazon
*  SSL certificate verify ok.
> GET /servlet/status HTTP/1.1
> Host: app.listhub.com
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 200 OK
< Date: Tue, 01 Dec 2020 21:16:35 GMT
< Transfer-Encoding: chunked
< Connection: keep-alive
< Set-Cookie: AWSALBTG=XWoM15qKytxq/BRMpTyNdzqv3vekDZ+VPL05sQ5MyytyRU09XXSI22B3cubI7y0D9VcqykC7q2Uq5gfZ1KV0B5et7rS8UOXrwBVEv17PpRSz70bKhmKSezvqV1MT/AaP5MDGJayp5XTIwpOyF+cPONzo9jOsgNTY5YNrVz4lp10q; Expires=Tue, 08 Dec 2020 21:16:35 GMT; Path=/
< Set-Cookie: AWSALBTGCORS=XWoM15qKytxq/BRMpTyNdzqv3vekDZ+VPL05sQ5MyytyRU09XXSI22B3cubI7y0D9VcqykC7q2Uq5gfZ1KV0B5et7rS8UOXrwBVEv17PpRSz70bKhmKSezvqV1MT/AaP5MDGJayp5XTIwpOyF+cPONzo9jOsgNTY5YNrVz4lp10q; Expires=Tue, 08 Dec 2020 21:16:35 GMT; Path=/; SameSite=None; Secure
< Set-Cookie: AWSALB=0wfmS+6+Ni/76LOs5mP0rdTlKDNrHBXHKq70YpYRfj9nvKzUtDs/2SzQuQegxX9gaK725b/lYpT0mTUcVWO6TekXcSG/kfSKilfs+IPiAZS09T4uzM+trnPgU/je; Expires=Tue, 08 Dec 2020 21:16:35 GMT; Path=/
< Set-Cookie: AWSALBCORS=0wfmS+6+Ni/76LOs5mP0rdTlKDNrHBXHKq70YpYRfj9nvKzUtDs/2SzQuQegxX9gaK725b/lYpT0mTUcVWO6TekXcSG/kfSKilfs+IPiAZS09T4uzM+trnPgU/je; Expires=Tue, 08 Dec 2020 21:16:35 GMT; Path=/; SameSite=None; Secure
< Server: Jetty(9.4.15.v20190215)
< 
{ [40 bytes data]

100    3Application Successfully Verified
4    0    34    0     0     81      0 --:--:-- --:--:-- --:--:--    81
* Connection #1 to host app.listhub.com left intact
+ docker run --rm appropriate/curl -f -v -L 'app.listhub.moveaws.com/servlet/status?test_datasourcs=1'
  â€‹% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                â€‹Dload  Upload   Total   Spent    Left  Seed

  â€‹0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 52.54.247.183...
* TCP_NODELAY set
* Connected to app.listhub.moveaws.com (52.54.247.183) port 80 (#0)
> GET /servlet/status?test_datasources=1 HTTP/1.1
> Host: app.listhub.moveaws.com
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Server: awselb/2.0
< Date: Tue, 01 Dec 2020 21:16:36 GMT
< Content-Type: text/html
< Content-Length: 134
< Connection: keep-alive
< Location: https://app.listhub.com:443/servlet/status?test_datasources=1
< 
* Ignoring the response-body
{ [134 bytes data]

100   134  100   134    0     0    905      0 --:--:-- --:--:-- --:--:--   905
* Connection #0 to host app.listhub.moveaws.com left intact
* Issue another request to this URL: 'https://app.listhub.com:443/servlet/status?test_datasources=1'
*   Trying 52.54.247.183...
* TCP_NODELAY set
* Connected to app.listhub.com (52.54.247.183) port 443 (#1)
* ALPN, offering http/1.1
* successfully set certificate verify locatons:
  â€‹CAfile: /etc/ssl/certs/ca-certificate.crt
  â€‹CApath: none
* TLSv1.2 (OUT), TLS handshake, Client hello (1):
} [230 bytes data]
* TLSv1.2 (IN), TLS handshake, Server hello (2):
{ [104 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4890 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Client hello (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Client hello (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256
* ALPN, server accepted to use http/1.1
* Server certificate:
*  subject: CN=*.listhub.com
*  start date: Aug 29 00:00:00 2020 GMT
*  expire date: Sep 29 12:00:00 2021 GMT
*  subjectAltName: host "app.listhub.com" matched cert's "*.listhub.com"
*  issuer: C=US; O=Amazon; OU=Server CA 1B; CN=Amazon
*  SSL certificate verify ok.
> GET /servlet/status?test_datasources=1 HTTP/1.1
> Host: app.listhub.com
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 200 OK
< Date: Tue, 01 Dec 2020 21:16:36 GMT
< Transfer-Encoding: chunked
< Connection: keep-alive
< Set-Cookie: AWSALBTG=fDrRH2SDv4GsiviEpyTyT2pJPLRFtFZbK5zLoGn5VTQifcAffjYxiuxDPiUvEEaucHGPJWKbcSS1YcUuGx5Xk3DUM7zDyfEsMJyO/keFSvOWGrGYWr682unVvc9zvrfYwyIfi6Vc42KvHIhFllaLVPFmk9biqDaOphDmarJYbVQp; Expires=Tue, 08 Dec 2020 21:16:36 GMT; Path=/
< Set-Cookie: AWSALBTGCORS=fDrRH2SDv4GsiviEpyTyT2pJPLRFtFZbK5zLoGn5VTQifcAffjYxiuxDPiUvEEaucHGPJWKbcSS1YcUuGx5Xk3DUM7zDyfEsMJyO/keFSvOWGrGYWr682unVvc9zvrfYwyIfi6Vc42KvHIhFllaLVPFmk9biqDaOphDmarJYbVQp; Expires=Tue, 08 Dec 2020 21:16:36 GMT; Path=/; SameSite=None; Secure
< Set-Cookie: AWSALB=SGhMJJ6poR/zFTqQBwf/QVHIMbLgE9NmzZbbfzFxsR/tOrPtRaDNMTP61G1pe0GJqaRyzLJKX3fQeEFx+Ke+lI984QylK1ZykjJiyPZjnlD6JGgxJ07PwRPFM17T; Expires=Tue, 08 Dec 2020 21:16:36 GMT; Path=/
< Set-Cookie: AWSALBCORS=SGhMJJ6poR/zFTqQBwf/QVHIMbLgE9NmzZbbfzFxsR/tOrPtRaDNMTP61G1pe0GJqaRyzLJKX3fQeEFx+Ke+lI984QylK1ZykjJiyPZjnlD6JGgxJ07PwRPFM17T; Expires=Tue, 08 Dec 2020 21:16:36 GMT; Path=/; SameSite=None; Secure
< Server: Jetty(9.4.15.v20190215)
< 
{ [40 bytes data]
Application Successfully Verified

100    34    0    34    0     0     65      0 --:--:-- --:--:-- --:--:--    65
* Connection #1 to host app.listhub.com left intact
+ export VAULT_ADDR=https://vault.moveaws.com
+ VAULT_ADDR=https://vault.moveaws.com
++ vault read -field=username /secret/industryplatforms/listhub/tests/pickup-v2
+ PICKUP_USER=alex.paz@listhub.com
++ vault read -field=password /secret/industryplatforms/listhub/tests/pickup-v2
+ PICKUP_PASSWORD=9e39b1c3782dd660809906ed6b4667ac
+ docker run --rm appropriate/curl -l -f -v --location-trusted -ualex.paz@listhub.com:9e39b1c3782dd660809906ed6b4667ac app.listhub.moveaws.com/pickup-v2/listreprts/
  â€‹% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                â€‹Dload  Upload   Total   Spent    Left  Seed

  â€‹0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 107.21.76.62...
* TCP_NODELAY set
* Connected to app.listhub.moveaws.com (107.21.76.62) port 80 (#0)
* Server auth using Basic with user 'alex.paz@listhub.com'
> GET /pickup-v2/listreports/ HTTP/1.1
> Host: app.listhub.moveaws.com
> Authorization: Basic YWxleC5wYXpAbGlzdGh1Yi5jb206OWUzOWIxYzM3ODJkZDY2MDgwOTkwNmVkNmI0NjY3YWM=
> User-Agent: curl/7.59.0
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Server: awselb/2.0
< Date: Tue, 01 Dec 2020 21:16:38 GMT
< Content-Type: text/html
< Content-Length: 134
< Connection: keep-alive
< Location: https://app.listhub.com:443/pickup-v2/listreports/
< 
* Ignoring the response-body
{ [134 bytes data]

100   134  100   134    0     0    911      0 --:--:-- --:--:-- --:--:--   911
* Connection #0 to host app.listhub.moveaws.com left intact
* Issue another request to this URL: 'https://app.listhub.com:443/pickup-v2/listreports/'
*   Trying 107.21.76.62...
* TCP_NODELAY set
* Connected to app.listhub.com (107.21.76.62) port 443 (#1)
* ALPN, offering http/1.1
* successfully set certificate verify locatons:
  â€‹CAfile: /etc/ssl/certs/ca-certificate.crt
  â€‹CApath: none
* TLSv1.2 (OUT), TLS handshake, Client hello (1):
} [230 bytes data]
* TLSv1.2 (IN), TLS handshake, Server hello (2):
{ [104 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4890 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Client hello (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Client hello (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256
* ALPN, server accepted to use http/1.1
* Server certificate:
*  subject: CN=*.listhub.com
*  start date: Aug 29 00:00:00 2020 GMT
*  expire date: Sep 29 12:00:00 2021 GMT
*  subjectAltName: host "app.listhub.com" matched cert's "*.listhub.com"
*  issuer: C=US; O=Amazon; OU=Server CA 1B; CN=Amazon
*  SSL certificate verify ok.
* Server auth using Basic with user 'alex.paz@listhub.com'
> GET /pickup-v2/listreports/ HTTP/1.1
> Host: app.listhub.com
> Authorization: Basic YWxleC5wYXpAbGlzdGh1Yi5jb206OWUzOWIxYzM3ODJkZDY2MDgwOTkwNmVkNmI0NjY3YWM=
> User-Agent: curl/7.59.0
> Accept: */
> 

  â€‹0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0< HTTP/1.1 200 OK
< Date: Tue, 01 Dec 2020 21:16:39 GMT
< Content-Type: text/html
< Content-Length: 17302
< Connection: keep-alive
< Set-Cookie: AWSALBTG=h32DN5CgTLl01HhgLu2HWbZVdIwEoLE1vHbqac+GcfQqZAGyDGkOMrsuhhG2DswLfYTumCezyjWOkPbIxeKQh98XWw5A6c9S8pz8LMhb/aM6eounMDG0FOIxVp5BlEEm5qfiTSC4fMWj+gTF0dwqNXxRU1EhPQ0HrxA6jOhAAtK6; Expires=Tue, 08 Dec 2020 21:16:38 GMT; Path=/
< Set-Cookie: AWSALBTGCORS=h32DN5CgTLl01HhgLu2HWbZVdIwEoLE1vHbqac+GcfQqZAGyDGkOMrsuhhG2DswLfYTumCezyjWOkPbIxeKQh98XWw5A6c9S8pz8LMhb/aM6eounMDG0FOIxVp5BlEEm5qfiTSC4fMWj+gTF0dwqNXxRU1EhPQ0HrxA6jOhAAtK6; Expires=Tue, 08 Dec 2020 21:16:38 GMT; Path=/; SameSite=None; Secure
< Set-Cookie: AWSALB=1+5ifxpG37DdHYZaeyGrEOKWeMQfeFinWO7fL/TshAF7KRtQNEkQJyf9FuA5ugyilE59+abb9WyLwrCMzSY/lxnleKoDMRSZwtIQR+NmuCLjjEX8NsMyuWraUH3P; Expires=Tue, 08 Dec 2020 21:16:38 GMT; Path=/
< Set-Cookie: AWSALBCORS=1+5ifxpG37DdHYZaeyGrEOKWeMQfeFinWO7fL/TshAF7KRtQNEkQJyf9FuA5ugyilE59+abb9WyLwrCMzSY/lxnleKoDMRSZwtIQR+NmuCLjjEX8NsMyuWraUH3P; Expires=Tue, 08 Dec 2020 21:16:38 GMT; Path=/; SameSite=None; Secure
< Server: Jetty(9.4.15.v20190215)
< 
{ [14380 bytes data]

100 17302  100 17302    0     0  13018      0  0:00:01  0:00:01 --:--:--  268k
* Connection #1 to host app.listhub.com left intact
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>Index of listreports</title>
</head>
<body>
<h1>Index of listreports</h1>
<table><tr><th><img alt="[ICO]" src="http://imageserver.3yd.com/image_library/threewide/misc/blank_pixel.gif"></img></th><th>Name</th><th>Last Modified</th><th>Size</th><th>Description</th></tr><tr><th colspan="5"><hr></hr></th></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201129_2107.xml.gz">listreports-20201129_2107.xml.gz</a></td><td align="right">29-Nov-2020 21:20</td><td align="right">9165873</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201129_2207.xml.gz">listreports-20201129_2207.xml.gz</a></td><td align="right">29-Nov-2020 22:19</td><td align="right">4032911</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201129_2307.xml.gz">listreports-20201129_2307.xml.gz</a></td><td align="right">29-Nov-2020 23:20</td><td align="right">12511668</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0007.xml.gz">listreports-20201130_0007.xml.gz</a></td><td align="right">30-Nov-2020 00:20</td><td align="right">16412525</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0107.xml.gz">listreports-20201130_0107.xml.gz</a></td><td align="right">30-Nov-2020 01:20</td><td align="right">19650596</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0207.xml.gz">listreports-20201130_0207.xml.gz</a></td><td align="right">30-Nov-2020 02:21</td><td align="right">21960450</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0307.xml.gz">listreports-20201130_0307.xml.gz</a></td><td align="right">30-Nov-2020 03:20</td><td align="right">13480721</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0407.xml.gz">listreports-20201130_0407.xml.gz</a></td><td align="right">30-Nov-2020 04:20</td><td align="right">11565235</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0507.xml.gz">listreports-20201130_0507.xml.gz</a></td><td align="right">30-Nov-2020 05:21</td><td align="right">18821088</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0607.xml.gz">listreports-20201130_0607.xml.gz</a></td><td align="right">30-Nov-2020 06:21</td><td align="right">7673556</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0707.xml.gz">listreports-20201130_0707.xml.gz</a></td><td align="right">30-Nov-2020 07:20</td><td align="right">25358735</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0807.xml.gz">listreports-20201130_0807.xml.gz</a></td><td align="right">30-Nov-2020 08:20</td><td align="right">21018101</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_0907.xml.gz">listreports-20201130_0907.xml.gz</a></td><td align="right">30-Nov-2020 09:21</td><td align="right">11598508</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1007.xml.gz">listreports-20201130_1007.xml.gz</a></td><td align="right">30-Nov-2020 10:21</td><td align="right">13034447</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1107.xml.gz">listreports-20201130_1107.xml.gz</a></td><td align="right">30-Nov-2020 11:21</td><td align="right">9995510</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1207.xml.gz">listreports-20201130_1207.xml.gz</a></td><td align="right">30-Nov-2020 12:20</td><td align="right">8255085</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1307.xml.gz">listreports-20201130_1307.xml.gz</a></td><td align="right">30-Nov-2020 13:21</td><td align="right">22613710</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1407.xml.gz">listreports-20201130_1407.xml.gz</a></td><td align="right">30-Nov-2020 14:21</td><td align="right">19073435</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1507.xml.gz">listreports-20201130_1507.xml.gz</a></td><td align="right">30-Nov-2020 15:21</td><td align="right">10843613</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1608.xml.gz">listreports-20201130_1608.xml.gz</a></td><td align="right">30-Nov-2020 16:21</td><td align="right">25814712</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1708.xml.gz">listreports-20201130_1708.xml.gz</a></td><td align="right">30-Nov-2020 17:21</td><td align="right">21813077</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1808.xml.gz">listreports-20201130_1808.xml.gz</a></td><td align="right">30-Nov-2020 18:21</td><td align="right">26097649</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_1908.xml.gz">listreports-20201130_1908.xml.gz</a></td><td align="right">30-Nov-2020 19:21</td><td align="right">34754540</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_2008.xml.gz">listreports-20201130_2008.xml.gz</a></td><td align="right">30-Nov-2020 20:21</td><td align="right">34297640</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_2108.xml.gz">listreports-20201130_2108.xml.gz</a></td><td align="right">30-Nov-2020 21:21</td><td align="right">22311809</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_2208.xml.gz">listreports-20201130_2208.xml.gz</a></td><td align="right">30-Nov-2020 22:21</td><td align="right">24806782</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201130_2308.xml.gz">listreports-20201130_2308.xml.gz</a></td><td align="right">30-Nov-2020 23:22</td><td align="right">30294680</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0008.xml.gz">listreports-20201201_0008.xml.gz</a></td><td align="right">01-Dec-2020 00:21</td><td align="right">23738174</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0108.xml.gz">listreports-20201201_0108.xml.gz</a></td><td align="right">01-Dec-2020 01:21</td><td align="right">21899569</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0208.xml.gz">listreports-20201201_0208.xml.gz</a></td><td align="right">01-Dec-2020 02:22</td><td align="right">27293057</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0308.xml.gz">listreports-20201201_0308.xml.gz</a></td><td align="right">01-Dec-2020 03:21</td><td align="right">19294499</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0408.xml.gz">listreports-20201201_0408.xml.gz</a></td><td align="right">01-Dec-2020 04:22</td><td align="right">19614675</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0508.xml.gz">listreports-20201201_0508.xml.gz</a></td><td align="right">01-Dec-2020 05:21</td><td align="right">25755463</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0608.xml.gz">listreports-20201201_0608.xml.gz</a></td><td align="right">01-Dec-2020 06:21</td><td align="right">14593957</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0708.xml.gz">listreports-20201201_0708.xml.gz</a></td><td align="right">01-Dec-2020 07:22</td><td align="right">18595136</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0808.xml.gz">listreports-20201201_0808.xml.gz</a></td><td align="right">01-Dec-2020 08:22</td><td align="right">13677849</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_0908.xml.gz">listreports-20201201_0908.xml.gz</a></td><td align="right">01-Dec-2020 09:22</td><td align="right">23697757</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1008.xml.gz">listreports-20201201_1008.xml.gz</a></td><td align="right">01-Dec-2020 10:22</td><td align="right">11090420</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1108.xml.gz">listreports-20201201_1108.xml.gz</a></td><td align="right">01-Dec-2020 11:21</td><td align="right">13046259</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1209.xml.gz">listreports-20201201_1209.xml.gz</a></td><td align="right">01-Dec-2020 12:22</td><td align="right">10870340</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1309.xml.gz">listreports-20201201_1309.xml.gz</a></td><td align="right">01-Dec-2020 13:22</td><td align="right">14558192</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1409.xml.gz">listreports-20201201_1409.xml.gz</a></td><td align="right">01-Dec-2020 14:22</td><td align="right">17830418</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1509.xml.gz">listreports-20201201_1509.xml.gz</a></td><td align="right">01-Dec-2020 15:22</td><td align="right">14032637</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1609.xml.gz">listreports-20201201_1609.xml.gz</a></td><td align="right">01-Dec-2020 16:22</td><td align="right">27830608</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1709.xml.gz">listreports-20201201_1709.xml.gz</a></td><td align="right">01-Dec-2020 17:22</td><td align="right">22731887</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1809.xml.gz">listreports-20201201_1809.xml.gz</a></td><td align="right">01-Dec-2020 18:22</td><td align="right">24707578</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_1909.xml.gz">listreports-20201201_1909.xml.gz</a></td><td align="right">01-Dec-2020 19:22</td><td align="right">42625888</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-20201201_2009.xml.gz">listreports-20201201_2009.xml.gz</a></td><td align="right">01-Dec-2020 20:22</td><td align="right">30783505</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports-index.csv.gz">listreports-index.csv.gz</a></td><td align="right">01-Dec-2020 20:23</td><td align="right">37911860</td></tr>
<tr><td valign="top"><img src="http://imageserver.3yd.com/image_library/incors/images/png/application/16x16/plain/document.png" alt="[ ]"></img></td><td><a href="/pickup-v2/listreports/listreports.xml.gz">listreports.xml.gz</a></td><td align="right">01-Dec-2020 20:22</td><td align="right">803476535</td></tr>
<tr><th colspan="5"><hr></hr></th></tr>
</table>
<address>directory listing for listreports</address></body></html>
[Pipeline] ar (hide)
[Pip{ (hide)
[Pipelio(hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeh(hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pipeh(hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] httt (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] ar (hide)
[Pip{ (hide)
[Pipelio(hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] librarye (hide)
[Pipeh (hide)
[Pipeh (hide)
[Pipeh (hide)
[Pipeh (hide)
[Pipeline] archiveAs(hide)
ï¿¼Archiving artifacts
[Pipeh(hide)
ï¿¼+ rm /tmp/tmp.0WDnvSS3uF
[Pipeline] }
[Pipeline] // node
[Pipelie(hide)
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[Pip{ (hide)
[Pipeline] t(hide)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tags
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-1784'"
[Pipeline] ar (hide)
[Pip{ (hide)
[Pipelio(hide)
ï¿¼Executing move_new_relic_notify.template
[Pipeline] fis (hide)
[Pipeh(hide)
ï¿¼ â€‹> git rev-parse --is-inside-work-tree # timout=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/listub.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key frommaster
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/originmaster
 â€‹> git config core.sparsecheckout # timout=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
[Pipeline] le (hide)
[Pipeline] le (hide)
[Pipsh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pips (hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipsh (hide)
[Pipsh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pips (hide)
ï¿¼Skipping New Relic deployment notification since the newRelicAppId variable is not set.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] or (hide)
[Pi { (hide)
[Pipelh (hide)
ï¿¼Executing move_sns_send.sh.template
[Pipeline] fts (hide)
[Pipsh (hide)
[Pipeline] le (hide)
[Pipeline] le (hide)
[Pipsh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pips (hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipsh (hide)
[Pipsh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pips (hide)
ï¿¼Skipping SNS notification since a topic ARN is not configured.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // node
[Pipelige (hide)
[Pipeline] { (prod Cleanup Ust) (hide)
[Pipelineu (hide)
ï¿¼Timeout set to expire in 2 hr 0 min
[Pi { (hide)
[Pipeliu (hide)
ï¿¼Input requested
Approved by dspano
[Pipeline] }
[Pipeline] // timeout
[Pipeline] }
[Pipeline] // stage
[Pipelh (hide)
ï¿¼Setting pipeline properties to [@disableConcurrentBuilds()]
[Pipeline] pes (hide)
[Pipeline] cor (hide)
[Pi { (hide)
[Pipeld (hide)
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[Pi { (hide)
[Pipeline] pes (hide)
[Pipeline]u (hide)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tags
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT1784'"
 â€‹> git rev-parse --is-inside-work-tree # timout=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/listub.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key frommaster
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/originmaster
 â€‹> git config core.sparsecheckout # timout=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
[Pipelige (hide)
[Pipeline] { (prodp) (hide)
[Pips (hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pips (hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] htst (hide)
[Pipeline] or (hide)
[Pi { (hide)
[Pipelh (hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] or (hide)
[Pi { (hide)
[Pipelh (hide)
ï¿¼Executing move_ecs_blue_green_deploy_phase4_cleanup_prev_deploy.sh.template
[Pipeline] fts (hide)
[Pipsh (hide)
[Pipeline] le (hide)
[Pipeline] le (hide)
[Pipsh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pips (hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pipsh (hide)
[Pipsh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pips (hide)
ï¿¼++ mktemp
+ META=/tmp/tmp.GfHkgi
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/ecs_blue_green_meta.py --ecs_cluster listhub-web-ecs-cluster --stack_name_prefix listhub-prod --active_alb_hostname1 app.listhub.moveaws.com --active_alb_hostname2 app.listhub.com --active_alb_hostname3 app.listhub.net --active_alb_hostname4 reports.listhub.com --active_alb_hostname5 reports.listhub.net --active_alb_hostname6 listings.listhub.com --active_alb_hostname7 listings.listhub.net --active_alb_hostname8 feeds.listhub.net --active_alb_hostname9 feeds.listhub.com --active_alb_hostname10 '' --inactive_alb_hostname1 i-app.listhub.moveaws.com --alb_priority_range_min 15001 --alb_priority_range_max 49999 --listener_exports listhub-web-ecs-cluster-internet-facing-http-listener listhub-web-ecs-cluster-internet-facing-https-listener --outfile /tmp/tmp.GfHkgi --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole
[38;21m2020-12-01 21:36:45,810 Found listener ARNs ['arn:aws:elasticloadbalancing:us-east-1:104222541211:listener/app/listh-Inter-1BUT2AQQQJ7E8/17b5fcd6770616ea/93da94ffc4dc8f68', 'arn:aws:elasticloadbalancing:us-east-1:104222541211:listener/app/listh-Inter-1BUT2AQQQJ7E8/17b5fcd6770616ea/1706bb5780f02e65']
[38;21m2020-12-01 21:36:46,879 Found existing ALB priorities {'43980', '26286', '20048', '25800', '38143', '41420', '16224', '17378', '39772', '20008', '31608', '48060', '27206', '31933', '18657', '28544', '42554', '49618'}
[38;21m2020-12-01 21:36:46,879 Allocated random ALB priority 34802 from range 15001-49999
[38;21m2020-12-01 21:36:47,260 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '28544', '49618', '20048', '20008', '31933'}
[38;21m2020-12-01 21:36:47,260 Allocated random ALB priority 37520 from range 15001-49999
[38;21m2020-12-01 21:36:47,651 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '37520', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '28544', '49618', '20048', '20008', '31933'}
[38;21m2020-12-01 21:36:47,651 Allocated random ALB priority 35837 from range 15001-49999
[38;21m2020-12-01 21:36:48,029 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '37520', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '28544', '49618', '35837', '20048', '20008', '31933'}
[38;21m2020-12-01 21:36:48,029 Allocated random ALB priority 23888 from range 15001-49999
[38;21m2020-12-01 21:36:48,409 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '37520', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '28544', '49618', '35837', '23888', '20048', '20008', '31933'}
[38;21m2020-12-01 21:36:48,410 Allocated random ALB priority 19645 from range 15001-49999
[38;21m2020-12-01 21:36:48,804 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '37520', '19645', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '28544', '49618', '35837', '23888', '20048', '20008', '31933'}
[38;21m2020-12-01 21:36:48,804 Allocated random ALB priority 32818 from range 15001-49999
[38;21m2020-12-01 21:36:49,113 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '37520', '19645', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '32818', '28544', '49618', '35837', '23888', '20048', '20008', '31933'}
[38;21m2020-12-01 21:36:49,113 Allocated random ALB priority 45671 from range 15001-49999
[38;21m2020-12-01 21:36:49,413 Found existing ALB priorities {'38143', '25800', '17378', '42554', '43980', '26286', '37520', '19645', '31608', '34802', '41420', '16224', '39772', '48060', '27206', '18657', '32818', '28544', '49618', '35837', '23888', '20048', '20008', '45671', '31933'}
[38;21m2020-12-01 21:36:49,414 Allocated random ALB priority 17450 from range 15001-49999
[38;21m2020-12-01 21:36:49,752 Found existing ALB priorities {'38143', '25800', '17378', '42554', '18301', '45271', '43980', '26286', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:49,752 Allocated random ALB priority 18338 from range 15001-49999
[38;21m2020-12-01 21:36:49,969 Found existing ALB priorities {'38143', '25800', '17378', '42554', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:49,969 Allocated random ALB priority 29779 from range 15001-49999
[38;21m2020-12-01 21:36:50,186 Found existing ALB priorities {'38143', '25800', '29779', '17378', '42554', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:50,186 Allocated random ALB priority 40302 from range 15001-49999
[38;21m2020-12-01 21:36:50,400 Found existing ALB priorities {'38143', '25800', '29779', '17378', '40302', '42554', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:50,401 Allocated random ALB priority 35302 from range 15001-49999
[38;21m2020-12-01 21:36:50,622 Found existing ALB priorities {'38143', '25800', '29779', '17378', '40302', '35302', '42554', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:50,622 Allocated random ALB priority 41723 from range 15001-49999
[38;21m2020-12-01 21:36:50,838 Found existing ALB priorities {'38143', '25800', '29779', '17378', '40302', '35302', '42554', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '41723', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:50,838 Allocated random ALB priority 26687 from range 15001-49999
[38;21m2020-12-01 21:36:51,053 Found existing ALB priorities {'38143', '25800', '29779', '17378', '40302', '35302', '42554', '26687', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '41723', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:51,053 Allocated random ALB priority 37832 from range 15001-49999
[38;21m2020-12-01 21:36:51,270 Found existing ALB priorities {'38143', '25800', '29779', '17378', '40302', '37832', '35302', '42554', '26687', '18301', '45271', '43980', '26286', '18338', '18219', '31608', '15697', '41420', '16224', '29194', '39772', '41723', '48060', '27206', '18657', '47378', '28544', '49618', '20048', '20008', '35309', '31933', '31570', -1}
[38;21m2020-12-01 21:36:51,270 Allocated random ALB priority 49546 from range 15001-49999
2020-12-01 21:36:54,739 Deployment Metrics
{"cluster_name": "listhub-web-ecs-cluster", "service_name": "listhub-prod-green", "service_min_count": 0, "prev_desired_num": 4, "cluster_info": {"largest_container_cpu": 256, "instance_type": "m5.2xlarge", "largest_container_memory": 7168, "asg_name": "listhub-web-ecs-cluster-ECSAutoScalingGroup-1OT4REVQXS7AP"}, "asg_statistics": {"min_instance_count": 4, "max_instance_count": 12, "desired_instance_count": 4}, "cluster_stats": {"registered_container_instances_count": 4, "pending_tasks_count": 0, "running_tasks_count": 22}, "instance_type_info": {"memory": 32768, "vcpu": 8192}, "schedulable_containers": 6, "additional_containers_count": 0, "containers_per_ec2_instance": 4, "additional_ecs_instances_count": 0, "new_asg_desired_capacity": null}
++ grep '^newDeployStackName=' /tmp/tmp.GfHkgi
++ awk -F= '{print $2}'
+ NEW_STACK_NAME=listhub-prod-blue
+ rm -f /tmp/tmp.GfHkgi
+ '[' listhub-prod-blue '!=' listhub-prod-blue ']'
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_stack_delete.py --stack_name listhub-prod-canary --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole
[38;21m2020-12-01 21:36:57,881 Stack listhub-prod-canary does not exist.
+ /usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/cf_stack_delete.py --stack_name listhub-prod-blue --region_name us-east-1 --assume_role_arn arn:aws:iam::104222541211:role/Jenkins --role_session_name JenkinsRole
[38;21m2020-12-01 21:37:01,234 No security groups were found in this CloudFormation stack.
[38;21m2020-12-01 21:37:01,529 Deleting stack listhub-prod-blue.
[38;21m2020-12-01 21:37:08,779   (CF) listhub-prod-blue: DELETE_IN_PROGRESS User Initiated
[38;21m2020-12-01 21:37:08,779   (CF) HttpRedirectListenerRule: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:08,780   (CF) ScaleDown: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:08,780   (CF) ScaleUp: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:08,780   (CF) HttpRedirectListenerRule: DELETE_COMPLETE 
[38;21m2020-12-01 21:37:08,780   (CF) ScaleUp: DELETE_COMPLETE 
[38;21m2020-12-01 21:37:08,780   (CF) ScaleDown: DELETE_COMPLETE 
[38;21m2020-12-01 21:37:08,780   (CF) ServiceScaleUpPolicy: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:08,780   (CF) ServiceScaleUpPolicy: DELETE_COMPLETE 
[38;21m2020-12-01 21:37:08,780   (CF) ServiceScaleDownPolicy: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:08,780   (CF) ServiceScaleDownPolicy: DELETE_COMPLETE 
[38;21m2020-12-01 21:37:15,423   (CF) ServiceScalingTarget: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:15,423   (CF) ServiceScalingTarget: DELETE_COMPLETE 
[38;21m2020-12-01 21:37:15,423   (CF) Service: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:15,423   (CF) AutoscalingRole: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:37:15,423   (CF) AutoscalingRole: DELETE_COMPLETE 
[38;21m2020-12-01 21:39:39,874   (CF) Service: DELETE_COMPLETE 
[38;21m2020-12-01 21:39:39,875   (CF) HttpsListenerRule: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:39:39,875   (CF) TaskDefinition: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:39:39,875   (CF) EcsServiceRole: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:39:39,875   (CF) HttpsListenerRule: DELETE_COMPLETE 
[38;21m2020-12-01 21:39:39,875   (CF) TargetGroup: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:39:39,875   (CF) TargetGroup: DELETE_COMPLETE 
[38;21m2020-12-01 21:39:39,875   (CF) EcsServiceRole: DELETE_COMPLETE 
[38;21m2020-12-01 21:39:39,875   (CF) TaskDefinition: DELETE_COMPLETE 
[38;21m2020-12-01 21:39:39,875   (CF) TaskRole: DELETE_IN_PROGRESS 
[38;21m2020-12-01 21:39:46,677 Finished CF deletion in 0:02:48.538942.
INFO: Term protect False on stack listhub-prod-blue:
INFO: Term protect False on stack listhub-prod-blue:
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] or (hide)
[Pi { (hide)
[Pipelh (hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pips (hide)
ï¿¼+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pips (hide)
ï¿¼+ git rev-parse HEAD
[Pipeline] htst (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline] or (hide)
[Pi { (hide)
[Pipelh (hide)
ï¿¼
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] librarce (hide)
[Pipsh (hide)
[Pipsh (hide)
[Pipsh (hide)
[Pipsh (hide)
[Pipeline] archivet (hide)
ï¿¼Archiving artifacts
[Pips (hide)
ï¿¼+ rm /tmp/tmp.6b3aTfssvu
[Pipeline] }
[Pipeline] // node
[Pipeline] }
[Pipeline] // catchError
[Pipeld (hide)
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[Pi { (hide)
[Pipeline]u (hide)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tags
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-1784'"
[Pipeline] or (hide)
[Pi { (hide)
[Pipelh (hide)
ï¿¼Executing move_new_relic_notify.emplate
ï¿¼ â€‹> git rev-parse --is-inside-work-tree # tieout=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/lishub.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key fro master
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origi/master
 â€‹> git config core.sparsecheckout # tieout=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
[Pipeline] sts (hide)
[Pi sh (hide)
[Pipeline]ile (hide)
[Pipeline]ile (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi h (hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi sh (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi h (hide)
ï¿¼Skipping New Relic deployment notification since the newRelicAppId variable is not set.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline]lor (hide)
[P] { (hide)
[Pipeco (hide)
ï¿¼Executing move_sns_send.sh.template
[Pipeline] sts (hide)
[Pi sh (hide)
[Pipeline]ile (hide)
[Pipeline]ile (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi h (hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi sh (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi h (hide)
ï¿¼Skipping SNS notification since a topic ARN is not configured.
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // node
[Pipeoe (hide)
ï¿¼Running on jenkins-slave-co7 (i-03bac934522239a04) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[P] { (hide)
[Pipelineot (hide)
ï¿¼using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tags
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPO-1784'"
 â€‹> git rev-parse --is-inside-work-tree # tieout=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/lishub.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key fro master
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origi/master
 â€‹> git config core.sparsecheckout # tieout=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
[Pipeline]lor (hide)
[P] { (hide)
[Pipeco (hide)
ï¿¼Executing new_relic_monitors.sh.template
[Pipeline] sts (hide)
[Pi sh (hide)
[Pipeline]ile (hide)
[Pipeline]ile (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi h (hide)
ï¿¼+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi sh (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi h (hide)
ï¿¼vault kv get --field=listhub-prod kv/external-tools-secrets/newrelic-rest-api-keys
vault kv get --field=value kv/external-tools-secrets/slack-webhooks/newrelic-monitors
/usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/nr_monitors.py --stack_name listhub --env prod --nr_key hidden --slack_webhook_url hidden --config_file deployment/newrelic/monitors.yml --policy_path /tmp/tmp.bDEaBm/nr_config.yml --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
/usr/bin/env python3 -B /usr/local/aws-deploy-tools/src/new_relic_alerting.py --api_key hidden --policies_dir /tmp/tmp.bDEaBm --stack_name listhub --variables_path /usr/local/aws-deploy-tools/variables/aws-globals.yml /usr/local/aws-deploy-tools/variables/aws-listhub-prod-us-east-1.yml /usr/local/aws-deploy-tools/variables/move-deprecated.yml jenkins-deploy/listhub-prod/env-vars.yml /usr/local/aws-deploy-tools/variables/elb-internet-facing.yml deployment/vars.listhub-common.yml deployment/vars.listhub-prod.yml
Using New Relic Policy File:
dasboard:
  â€‹description: This dashboard is automatically generated and will be overwrittenupon
    â€‹depoyment
  â€‹editable: editable_b_owner
  â€‹ico: none
  â€‹metaata:
    â€‹verion: 1
  â€‹title: listhub prod [MA-Auto]
  â€‹visibiliy: all
  â€‹wdgets:
  â€‹- ata:
    â€‹- duration: 4320000
      â€‹entity_is:
      â€‹- 39964489
      â€‹metris:
      â€‹- name: Memory/Physica
        â€‹values
        â€‹- used_bytes_byhost
    â€‹presentatin:
      â€‹title: Application Mmory
    â€‹visualization: metric_lin_chart
  â€‹- ata:
    â€‹- duration: 4320000
      â€‹entity_is:
      â€‹- 39964489
      â€‹metris:
      â€‹- name: CPU/User/Utilizatio
        â€‹values
        â€‹- pecent
    â€‹presentatin:
      â€‹title: Applicatio CPU
    â€‹visualization: metric_line_chart
policies:
- chnnels:
  â€‹- configuratin:
      â€‹channel: '#listhub-stats'
      â€‹url: https://hooks.slack.com/services/T04PEP24A/BGY0P356F/0eTdSENzhkmjU1G5qObUk7b
    â€‹name: '#listhub-sttus'
    â€‹type slack
  â€‹conditons:
    â€‹apm_browser_moile:
    â€‹- condition_scope: applicaton
      â€‹enabled: tue
      â€‹entitis:
      â€‹- 39964489
      â€‹metric: user_defied
      â€‹name: Application Memry
      â€‹ters:
      â€‹- duration: 
        â€‹operator: abov
        â€‹priority: critica
        â€‹threshold: 204800000.
        â€‹time_function: ny
      â€‹type: apm_app_metic
      â€‹user_defined
        â€‹metric: Memory/Physica
        â€‹value_function max
    â€‹- condition_scope: applicaton
      â€‹enabled: tue
      â€‹entitis:
      â€‹- 39964489
      â€‹metric: user_defied
      â€‹name: Application PU
      â€‹ters:
      â€‹- duration: 
        â€‹operator: abov
        â€‹priority: critica
        â€‹threshold: 80.
        â€‹time_function: ll
      â€‹type: apm_app_metic
      â€‹user_defined
        â€‹metric: CPU/User/Utilizatio
        â€‹value_function max
    â€‹infrastructur: []
    â€‹nql: []
  â€‹incident_preference: PER_CODITION
  â€‹name: listhub-prod
New Relic Dashboard is available at https://insights.newrelic.com/accounts/1921282/dashboards/971092
Successfully executed 1 alert policies.
Find them in New Relic prefixed by the stack name (listhub).
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] }
[Pipeline] // node
[Pipeline] }
[Pipeline] // parallel
[Pipeline] }
[Pipeline] // parallel
[Pipecho (hide)
DEBUG: Function Called (completePipeline)
[Pipeode (hide)
Running on jenkins-slave-co7 (i-0075e86d067c996d5) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[P] { (hide)
[Pipelage (hide)
[Pipeline] { (Calculateon) (hide)
[Pi sh (hide)
+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pi sh (hide)
+ git rev-parse HEAD
[Pipeline] hest (hide)
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)

[Pipeline] }
[Pipeline] // ansiColor
[Pipecho (hide)
DEBUG: Pipeline Time Calculation Started
[Pipecho (hide)
DEBUG: Pipeline timeStop (Tue Dec 01 21:40:38 UTC 2020)
[Pipecho (hide)
DEBUG: Pipeline Duration Unformatted (1 hours, 5.937 seconds)
[Pipecho (hide)
INFO: Pipeline Duration Formatted (1:0:5)
[Pipecho (hide)
DEBUG: Duration in Milliseconds (3605937)
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)

[Pipeline] }
[Pipeline] // ansiColor
[Pi sh (hide)
+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pi sh (hide)
+ git rev-parse HEAD
[Pipeline] hest (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)

[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] librarce (hide)
[Pi sh (hide)
[Pi sh (hide)
[Pi sh (hide)
[Pi sh (hide)
[Pipeline] archivcts (hide)
Archiving artifacts
[Pi sh (hide)
+ rm /tmp/tmp.d5OygNgFW0
[Pipeline] }
[Pipeline] // node
[Pipeode (hide)
Running on jenkins-slave-co7 (i-0075e86d067c996d5) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[P] { (hide)
[Pipelineout (hide)
using credential 4c024f87-baf1-47c9-8eca-97ab168ac0f5
Fetching changes from the remote Git repository
Fetching without tags
Checking out Revision 5ecee2431eb6cf4edeb00cfd5470fc46705557b7 (master)
Commit message: "Merge branch 'TPOT-1784'"
[Pipelage (hide)
[Pipeline] { (pind) (hide)
[Pi s (hide)
 â€‹> git rev-parse --is-inside-work-tree # tieout=10
 â€‹> git config remote.origin.url git@github.move.com:IndustryPlatforms/listhub.git # timeout=10
Fetching upstream changes from git@github.move.com:IndustryPlatforms/lishub.git
 â€‹> git --version # timeout=10
using GIT_SSH to set credentials jenkins ssh key fro master
 â€‹> git fetch --no-tags --progress git@github.move.com:IndustryPlatforms/listhub.git +refs/heads/master:refs/remotes/origi/master
 â€‹> git config core.sparsecheckout # tieout=10
 â€‹> git checkout -f 5ecee2431eb6cf4edeb00cfd5470fc46705557b7
+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pi sh (hide)
+ git rev-parse HEAD
[Pipeline] hest (hide)
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)

[Pipeline] }
[Pipeline] // ansiColor
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)
Executing move_send_pipeline_event.sh.template
[Pi sh (hide)
[Pipeline]ile (hide)
[Pipeline]ile (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.getBuildinfo but wound up catching org.jenkinsci.plugins.workflow.cps.CpsClosure2.call; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi sh (hide)
+ set +x
+ set +x
expected to call org.kohsuke.groovy.sandbox.impl.SandboxedMethodClosure.call but wound up catching moveContainerRegistry.dockerPull; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi sh (hide)
[Pi sh (hide)
expected to call java.util.LinkedHashMap.run but wound up catching moveContainerRegistry.dockerRun; see: https://jenkins.io/redirect/pipeline-cps-method-mismatches/
[Pi sh (hide)
[Pipeline] }
[Pipeline] // ansiColor
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)

[Pipeline] }
[Pipeline] // ansiColor
[Pi sh (hide)
+ vault kv get --field=access_token kv/external-tools-secrets/github
[Pi sh (hide)
+ git rev-parse HEAD
[Pipeline] hest (hide)
[Pipeline] }
[Pipeline] // stage
[Pipeline]lor (hide)
[P] { (hide)
[Pipecho (hide)

[Pipeline] }
[Pipeline] // ansiColor
[Pipeline] librarce (hide)
[Pi sh (hide)
[Pi sh (hide)
[Pi sh (hide)
[Pi sh (hide)
[Pipeline] archivcts (hide)
Archiving artifacts
[Pi sh (hide)
+ rm /tmp/tmp.tULwqSLapW
[Pipeline] }
[Pipeline] // node
[Pipeode (hide)
Running on jenkins-slave-co7 (i-0075e86d067c996d5) in /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master
[P] { (hide)
[Pipecho (hide)
applying default log parsing rules
[Pipeline]ile (hide)
[Pipetep (hide)
[Pi sh (hide)
+ rm /var/lib/jenkins/workspace/IndustryPlatforms_listhub_master/parsing.rules
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline

GitHub has been notified of this commitâ€™s build result

Finished
 Help us localize this pagePage generated: Jan 6, 2021 2:09:11 PM UTCREST APIJenkins ver. 2.176.2